// Copyright (c) 2026-present The Bitcoin Core developers
// Distributed under the MIT software license, see the accompanying
// file COPYING or https://opensource.org/license/mit/.

#include <crypto/mldsa.h>
#include <random.h>
#include <util/strencodings.h>

#include <boost/test/unit_test.hpp>

#include <algorithm>
#include <array>
#include <vector>

namespace {

std::vector<uint8_t> ParseHexStrict(const char* hex)
{
    return ParseHex(hex);
}

} // namespace

BOOST_AUTO_TEST_SUITE(mldsa_tests)

BOOST_AUTO_TEST_CASE(mldsa87_custom)
{
    const auto msg = ParseHexStrict("f9abc19b6648657912ea55dd39d9e462d83eb3c16cd0656bd8236ffc92d5911a");
    const auto pk = ParseHexStrict("8a9d3f21d2e9cbbdc75ef8f93fbd6ff45641e018410e4fa1c5c3a2c091aa75686388c5c0fccacc67671fc1a4e273b8397cf66c7aa6992b08c6b37fa61a8fe8e73a0f24993f48e883f0ab7e9f95dbdc2ad5d0312590b9148d506f8e3fbedc5cb60a6f6f2105b61385c7ff1f4a4ec832513f1b0ca7552fb12bcf8dcdb30153165a892aa96250b99985bb6d6e540fb1242b71e3f685759d1a3ebad0c0a42ee6aee16e4785982b8af06e427bd9f821b25e2ff3b56042cf4230a1c7d6269c8442670fabead1b57631618d7c879b3e2676a5949f815ca9e82306cebaab313066831614a2408838c1d9fa34659cfb88e60a4e66f29064eded4dcf12a5192d77d76374f5d2cb5480a3394296bffdf1fe0d4a3a4083146d2a3352007bf41411c720616e0d7594582aeeb8ec9f6e27e3479d833c9f85310412670473ad15ac78e6881bfa632e6957d00bf3fd37b6bcb6dd230d29b2dbbcf380b24c4b35ed109f0bbceeaa42c69af30231945ba264f77ecc445ac5f74216cf5f19f69dea2325355942625c8787fdeba9a56f359bd11073e6b8a334fdc55fb268e5c9cf502dff2236f602e59b3d15bb78d2ea158852dde58446a034ff6ac5df07f76e950934c270a30d03eb8b553fd1a4110131a2046d0e2b9f3ae61a049ae5827da3ec0496675cf0feaa7cfd524c4b01a9c224bec0897fb19f27a31f72e3d11592dd7b9e14af1d57e3846ebf1ae4d21ca52a346573cb5ad8fd25712aad611c4370299a040e4b4744125a71ce9224c964c640113df627fca90a6d9a3ebad66ba54643129e69dc1e5fedf16a15a247fbe376fdb4a4bbd52c4a096e25ae3e9b4b461b07fc6c27d83a48128f310cd248b0b586103c15b2cff1107d5c05c2aa1b678db950c91698a6cba4e0d6a811c8389b938b56c624dfaa951d75749c766b30840ce9664c93e8c4f3ad8aa1abeeeb32efcd22f50022d8c96e35af3eb6714d697049334b54fa7ee0d9bdfe160c4990f7fad91dd9ffe32b7865cb9189e8c021de906df1dfe62a917303ff9c6cd65d8cdbf8482397a37b67445b04bb34343a5b4952f7468d452dc70b4e9592f6e210912fda3c202f9552f5df98ca243e987133a799ebaa29ba2d2fed9c392568f548b29d1ee8e596c4aea8571df43fc86d3430c7c9b44a5fa2c9dfcdec232eefd0c43ba1e425cad2bc4a41d63379074817a238c796949d3a0061467dc637ba2d78840c3ab1c16aa1683dfb34244931afdf825134cad158687c83ece770d2e721ac1799890e7695d905b470c198ccf63e8ec136c33b65cd34413e02b9f0e985ec89205d9d0d6cc830d6a9ccc45dc4cefd6d5c5fd778ad1d4c416f09d71ef9cf81b5ffedbed6d344d907773d5d519d9608005b3c2ed68e7eb5bf887588c47aba56f14fdcf7c63c21f39e3c269d7362edd06f9cfed46ecb0f9107dd1b40182136d7855eff5b2b60fe1f7ab0aa22f14a4e9af7504cb8254f5d48eed72ba464f76decc5fd18e4c42b863ac1381c2c7524d4c8dd458de6ebf88518b94babbc8550e640d546e2482727ce0c448c639fcc38332c75f842be9d75067449ccd389f4db18da257f9ab37ce4928531ee969d16158681ba5cfc148562df6919021ad26278b9a35ffa02fb9a5a7f921067763c51d9a535c784d0c54cafe2861a4c89a7030c67adcede4ccf1337c331e4609f49bc3f5cf54d6cb75f64ed4265ec8fedaa42702d4b7cb4363d4b7945110f30fe7acb1352ec7b7d02da181c43a42ec5c9b38c7c2928e5f35ad714bfb4e172c4a839d1c6d408b2b3ece018a2b2e88ba92403b3347d79e2957027109740873af4909ee9ae13bc6fda629ca0971cad70deef4ba6635b3f1cd84963805b664c55d9934fe344ec1595ad7504c8c2357b90870b1029171df9f391e95c0973adde34359279144c84f97c156fb60487cc263a47106be512a92334cfd28e32a6cfd847b6690a13fe58e6e34ccfa71af7baea1fd29991895a323c5ecfa6b79ef9f26d79cc5827da287c689a33a7cad0708218f6dd3adabe2be16c767e13a7349eb01afbc330875e896ec1e44a0653987c9bc08a247c0db52a0c85753d87630f0caad27807167770362d7dbeb8bfbcf2e6cfc2065a9382fa98283a66a12440eabc001c33ac4d6d8074c1d72efb6a97f501424214eba479ed192642346713a0e4a025b3e1c76cdcb57d2bae13ca3d44558069f96c26060274b7bdd5a9df4728a88bd828ecc023cf380bea82d5962d95bec297dffd7fd0b798e5ecd9b7fb05617b75990cb9036673bd18a810860b4c2aa9c7c1e6dd241a11053db81b6ffdbf2d5c28b12e7b82c64551b5e6d4ed48b600815a3789978497e2cef8adbd050e1a0c42cec39119a00b0792cbdef99909de2fc76c929651edefadae5d9e45da49c5dd10b1f320cf471786d32a1850fa5816aaf4fc1b7a129e631aa61a72ea6ed979035581e7077c066715bf967feae5e001101c38ec98383cdd6c47d4801f5f4e0732f7632866d510b7aaedd9f355584e9a807c2a7d8e706ed5082db179173c021e28123c69f21c744fcadfca02499f3c60714b6ccc63605782e763e63cc96635dad23cb4cc628163025e61dbc3200f2d59ddfe93f90fb32ed76918efdc8f7fae6721c7b78a6b5eab2f18ccd11525c78e931953cee49531ad2a1e066ee2084ba1f247af4f8c2b9c63d894bbd0a964a7b527d9aab3d20536e6df2492086c2e49e59189c3c97e59ea86e4f7d609f2a2fe95eb0fef3d6a6fdeb5eb0bd02fb187e0d889a5fc17f4897bd7b305be12ed084a720fe4e5198fd3fb31740247bd90544bd5982abacd2dcba5c7bd7947d976c113da977e2d3786d12728fbc4b552ac8bbd713332ee6f1249fd2812024f096caa3c5a6efce17e9a83f93dd4823a0ca5a2323451e61cc146de090f0d548997acf994083653f73689b9db3cb89364aef0638539502a55d75488e0cc877f00e04116643747e91ea30864f5b3d07ec7b1046eb9a95e5ed6b5927ba52d89d246a84d6d20c44b915ac24d5a397e1fbb63e6ef2e7bbd1f2ed36941558e2dfeeaeee0de2b5d5dd0156f54d5e624347d0082c8e1f4157e580a15851d1263687303dcf35b38071aec609b502fca29f1eb6bb30ef926a57827aa4dcfdd3bb474488cb0bb00f87267f2fdaac2340a537a535dc1730a3952d9a3a69c3dc701b9f18b6e4c7e9f6b7c0c5fb4d4a7e1a5d28f840970fecbbe48a0470286b37ff4ba052feeb0c94ed4dfd59f6b676bad66ac14731bffae04385a826ae5c1f775386a5dc5e79f902d89fe6c9824803574c359977d61a3bee2e4257e44c1fe29240b333e8dd9021ab8ca7c60adc620e0f49441efde054cccf6113aa97965f00a8e669a6d80b2627b5a790cdf65b88c69c92ca2c0e13e98e65fefde62a87dcd44d2ad443e1d3dbeeae4f06cc83455c901de3ee053cb7e6109e294beef31b075e86b0a42cf803f813472909c0f352e92302ece02d0a082de93a4453436fa09a1adb89e15eed0825a52feecfbb4855df95c5bc7a002f1aa0b8a5ff576ff9b33ddf31ad6a1ac96531cbb2bf55891b8321b02a5ab03f492c1848efe915d0229aa6b25403c95b896f7dfe17f4aec426e34f1de26a7e6af7bd978dcb628b336b4a1175778a5bf1a3d0942b0a75fefa6e0fe8f4c0cfa1fb670b06bd06ed24e2a");
    const auto sk = ParseHexStrict("8a9d3f21d2e9cbbdc75ef8f93fbd6ff45641e018410e4fa1c5c3a2c091aa7568fe14920a6e205e8150cbc39457e56252e2d2946556c0f756b562d1a324894663f6738d126abd0b00361d6a8f0a4d5b58e366f147eaa367118ae92d91330d11b2436eaf70351ec219950490b13528150fcc4a1489b19ef90c6c5804d5030f38bf91386a21896ce1242c9bc444101389cb084282a261c11861401284cb148c113330a3206dd0c830d8c49018c86c213128cb38895aa861234170db0808cb48662232498c860d1a2242ca088e0b42615886882009241a3942c99810a438518882800222724802440c35098c1404d0046e4b16911c45208cb2619146225c48715a944088b86489b04418040c5ba24013b2601c92890ca51020357009c189d184649a964951002a6320885a886522a185140388d20664620648a4c8890b9070c14231ca48641ab05063848da3460d9bc22111428ad880004414920a8401a0268a022191d322508a3272d1140e12492824b88c08b07059406524472559366098080a0408412335061aa90413394ca316802247069322428b104e61066e94922512478e2019700818060a338a231822c13600a134002223840b10884a102cc214920c4104d91849c346249ac8811b21660120111a8325513690602272dc9690934872191530c20209c3a80dc3202d58322c2184701ac608db38485aa60549448119c62c84c8401a811023378a2324220ac3849c282e14b70553240a0c424ec8188c11b40182c29194386ea4a208cab871e2026601b5701205328b36900a296908449188a62002374603116064048e5b4004513666128265c080850b397210996dda442181488a53164180968098926412116100431050c26920c4301cb12c08416d881832844610a4a4252322690c178814a99054320c8c286cc24286821640c2406a5c4232d114640c848cc0325280c4601b3549e33428021292d1b23019864004012622a684cc9004e0100124344ca0402d23128013c28412a01108130010b42880208a9020881207894a1025084951d0985083b48d1c366acba411633286e01010cb3464c490642324002300461ac86c13908819366603b68063422ce1886194b8400349411247909b446a00460292368c0b446ec28468d9146984c86962460490c6684c8861193692e396481ab28910b48c02c86c0ca360cc0691c90860044751d1c02d483252a2a885d346288182655408821aa328d2868d8318619a382c0a854d13910de1400e6048911c80059a240a23b544914440490844094809e0264ec3441124b4310a36220123689bc411e2308440304212495024020d1406715b18299a14422127608c860dc422488b145142146e19290a8410494b2892822021a436011b475009814c01c888e4048603496a10138442128110356e212580da326164b68d199981998610c1362e1bb12408a725411645610088232109da04488c186e0c466964b62089088604b708a34609d422519288919a3265849608a4024a5a30650398854a268ad9906d21860451b690d1202e89444093464504a7245c986893048a81907111224843806861244648284688426e1812125128021b1492db40100c086d0b9270e0802c13b769028384db226252b80053c42c8c144a213021803845d8b630140144c4360dd406400106480ca0281c280e531666e2340812354a61222e23a4819bb061a1c604988691c31209022564233040da24419b148cc2181001344c61146441884c4940290a360c2102811b9991db30408bc60094b60102136c22a37009144a93b885e0a00d93148a51980019a10440b00d031932e1104d518211d108921498515a8604d8a42c123625584464921460a0a651d13005193286a4328e130921e22832e3128dd8404ec88208e30482c1882dc4b82dd1a48d03038da4180009a800c1804804096dc8b06118b500e2326c819468033050a1a045199104042805900446612645933602d2c420dc943008a50122a221c89201dc4005030189c242405914441839409106262432701c3512612891e4c871044701922692191349da2471422692d92469a4c08509358c039370240208e2346a0ac46018164400c70c62444561948c24c9318a00492143706284310930009994319c122d0c412d018704a1b88de24462180660c22049d0a830e3b08d10b920d3c04084c26c3bac5de5de2c3d9d5ecc2b3daef680319e432db3ec8a0ad15ec7974999d3ebf3035ad17037a9f7c3f19e3b590a46989a5ff36407eb0a4b26b64d8024ccf78eca2446d82d58961336fe100614fd5b88cd861d874cd7fff8cd13fccb27085c52a3ce0cef07af7221e704f5aaa6956a0308e5c0001e894a4defc432534c352820e7a2ac3358ef5ee331b499bfabc010d2b1bc7d8ef69b6e0220c9be0e63129d78f8e103155f0e0023116be758d8e1a41297a2b323e0a309547d87d48ef11b06037ed7b8d2cee2f537644c1b554aeb193e39b3db86750d48f8530ce94d00dc11ce87ea0d179b738a7de5bf08d2a160bb38c1d867682215886c8901c351f7923d850ad65266d04e68543c7d1fa0006b38979dc349baca662d1ba1e1e2d91f3e952d285352e62412cfcaa2a9b1993fecce6380b2ffafa755baffacd0123db1e8b460a9da131e4a1a399b0c7a283a2efdf7e60c87f751f11e63a589ae278671ad2daba00a254529f8e9306f81003d9674d02b84ee56fed743e8ecb723f4a4941c884f4ba52814bbb3cd7892f4c3fe93d933ac36850b06804fdf4f1098ef45fb1efb33d08f8490b764a7b87fcb31f4e53aaf510a52417733f43d0baea093957f6ea76f3b7eaca9fbf8e99802b73d4ff87eb80fcc33f4daa01eae565996def4f9d6944ddf30c773a60cce14f9be9657e6e9f2334cc0e54a049806bd22fd65ab0b14d998ec5594cc1c41d5f8197f6bdb2eac95cebf2cc9cc62881bba3e2c35008884e0e63ac026432a061be2b04a08cd8ddbf3f6306b7c1a3a0a676ae74c5f02661f0a574249ab30f915b12eba134e62c699b55bd177f1c9f6488ba72816d66d88a073b2630232786fbfa473d2cf9e71b053afadcaba15d21f6ac555e47986adee0a49a916a824d7d0714fdcdfe2283bdebcdbd9ba4baa08cae3ec2d2b0f0d32164b657197c11145952e75bb18bae65445175c0138476b4d3022b3e0e3e8ba60357cc9504d79405fc323088b9eb3b99c3b18aeafe83000b1c8c265a8253a0c5949308d1b3490b78dc5c35885eebc0599dc0a0cbf337cf599b4c5956cdeae5ae91129a085a49e72cac49c244965c478fd4a60c5f93980f32a587a6334f3966ffc969c31d1b265a391a7539e2e8bbfd1a64e5e1ad54d1af224522a5e93d746a7eca356cd78491733f349fb192ad35704577fb7cde38ab818a31be4f395cd3d7c26ac7daaef8c8a107695a4db759e3a253cdcebbe1d935eb42ad50ee67a400dbd8d51dd4ce6736551b0a3812b8745165c85cc92ed08c68523dac66ec75472df16b40550238c3e4f302a0c0e14d2aed0c48926b84d2083497e2f8ef6b7a1df3b26842a733b7f84867449212078d90d6d8ae2bd1a37a3d73c5c143a1da8cbe1c106c4b5d6c158f9cff92d863359be478edda6f05bb6f8628bc77bd5d030ff57bb96da89c7a044d79a856054045b5e69d275207205f6eaddacea8638f48d6fae89b379bd815aebf91e6c733cf3e658c0f948cbe193cb7337fa06d7b9d78ff3d7ea7f5f637342f4df6e4078240445b023d39110a52d1fad48684703f80de60566357cc8302f6b7bf26eb06245792875962a88566ad6fbcd4c75b9a3d95dd220bde21418563c276e6c9986f095a88a91350a8341cfe3431bdfec1df17afd29adf6007cf85255155d25a0e45689005420bc46bb2f772839ad73a9672239a86feed6e7662af8ec8a33b82011e67d316cf498161586fe572ac1bb38d5e5913ebb920c2e403b7981380d3889f29a08441eedd8f7a1717e3953348f1a47596f90e589c338e0fd13c4634bdf01ddad6443f6008ca47cacce26aae2e86d1d1d9c95ef6a0d9a4a1c743e51e417899cb03eaa03f5293d2340da14284839ca66e8c0ca120915fe6558c6ec2ce3e56f3a247b90de7498379bdd319a94e9d69f8f35671c86846d9cabd7ed184336f96c8d85db1c6b40fb46901c40bedb92326c7425205d66f8fb0ac23e165874662363e37210f102c7e7f820f6de5c5e2140f12e48af9a7b1260e354da72d62bfcfbac7b49e7303d6a8e3a2f3d6f3a131edaa7bcce70d9fbfea0a1892c5e8b7126106ab92e562a17fbb4c344252ae69219ddb41ea55ac0aae6de1838c39c2b600bfab835413d3c2243a7ddae6cc26e37aac6a781ef1e2f6201651e189af63904f74b6d5c0969d26e46e44072959588cdd3ad3ca321529ea7aa82e214989b70616003c5e3b1ea87b9db7782872458ee8477fb02e2cf8c1327cd74988cea5cb9ba602f6a2598095f57283567160c0f163d109b0cd255771a56d8e2199c14bec3f46a7e1af5a28ff4deb6a95f3862b66c264ef14067e4d58669c1452f3cabd3e4c71d31c0988ee708a7be3cbd7843f1ab12ac87b998ac4a82dfa4cfbd6c0a9ead9f94e4728342e727e41b33e8215f0fed35097dd43f1d6dc87a19025aa9c76311965b518a581d22fba48db67f9b27603e1a4dd63bdf1ee81ae9ca38d6723cf64499960f78b92d76b7129be3e1f3c3613ab99013503ecc79088bc68bb28c138fbae2d51de3122c336f114933e3e97a8e3470b42812ff2a93e352cb301e6a3cfbe9f5a5dc9d508161b8110e858e6f67dd487421a761aa00b145c0260c8b5196f70a99d8ea344b4f712b6ba1f95d4d75ff282e9db4f224e75575ce7b918bb307eb27460e09af36fc44be4d0ab1f6594695630ad5027f7f86c9aa0ce0d46639f1354beca5731e5138cfee25b835e2a58abbea9541631e81211e40433c40d0bd651c068347286ee26d33f9f72519724498592ec4a4bbb209884fce5c5d125cd7f291f86667327e5b9b72c3fa77600bb4aeed0a13942df64c24de7a8ee060a7ae2b7ddeec3c3e5fe83733c053df071bb5e1f7415f777ba323f4c39325fe6765eea0ae961b5930bcae695c0954e61880559604d80bd6abcb515fcb8516d2b15458e27052fb15dd9b3ab9d2cdf3f7e38b0bcc883f7d2fb617a2f78a1eb71545b48577f10758906c7f64b144fef0013ab5e20c5288c7a9c59088e5d04938dc9ffc3467006abdd615eea4e77dd5b0620385087f8bbf1aa215d19ccfdc7ba07262592971193e99ef1058d473f13068cf11fc87ec9932872da9f069259e00fae4c4d960ae8280101cad71d2b276eca495f0eb0e841a7e66c3fac8a9491a1da34131be225c15cbed91963692f710f30e888c9456a252abfde62a3e283efa0fc9f722907ef4f408e106a2a5403837d559f493886b4e6523f6e3d578db14404ed9c742f48c5af3bda687ae5d9aa2b81d4c029f5b925692cae23938afcd2f4ffd46082fd921e6fbac4bca2ea6f4154bf04b67677f94d81b05ac1b5ae6595bb0ab17e5d474efdf8b47d489c6ada1551988f365ef6b9ac8d9202ab25c3bd73f61007577e772465307260a12b17273235a852f36ac4dd526b8b904eb59fe48fa9a64f8587ad3983f73701c12516b3c1244698e778467c7f45566b16c8f98142f3a65d750f81096fa5640573b0c2fa763810718790323929c23b52ed4d1e73f8247aeee0b4e7b5ecee24999a7c31d8891c3024ed83f92c002fd1e58bee4fd538a3d535402ad5107b0553eae04dfdee345387e0ed9b995baf19f447e6687f359cdce9f5b6725b3ccdd0fc6d7239c06e3e394421f15a436f46fe6e3c1ef1c0218e81cb2d99c0322596005b236f12cc47b8959ee55be542408449363591d97e49138e4384910aacdb0567a77df9c7c1feb2dc1a1312cbe260946b097df637693125135b03c6547daa9af1c5358972c77cd0353b97a7b2a436c2f83df3a9dd8b93b7854053cbb44fb852531321cba05caf77819f88b9b4b98c4252496ec076bc5aa74ee1a55f5eaa4a8682e03798311eb351783e8a32fdcefe16927c81313e031ba93bb42b475b4715d78672a5d67ebe6fa49d2be3814ffa740eab54cbc1a1dabd95bb2e66bed529fb23397a63ab1ca71b26a46e0d8dba24216d1472a4710196f164b4520eb60e73397a9054dc211e4291e3dd6043194f23f71d56a3531d557dc526b0da91e79b5274174e96b6663314e0a5c82efc662351bfabd5ff9d7bf224dd2de82e18de4e38fc69d6f1bb3a79a8284529e01da1c99f863738683b4cc28a0ea03d4e8ee618dfb88ee851d52e829f895ec2416024055173d0cc7979b0b88f8319ad02d839312e59001c675105cd3a6e72e3c3a4c6c6e192dfd843cda8e5e65f2abb3854a6615517543028793ed0b95aae7e70bf9139185d7748c0c549efbd83c72017b42dbd262b3cb9a69820b9af382bec450ea20424a99ef283cca6dc5ff1ecbd526084e62388831d71e2bf60dfb93fecfa9cb035551ec90a173aac9fe828a213f4cec49efce9ea0de1e7de5d0a1a08aaf0ff441bae24c5d959a6c0da5d3a73a2063c70ce55dd0fbbd349a5f75029a4a68a6397298ed559f7acd069502d4e140fd0d83e2e00289e7e1dd7aba1f9412f2b3d4574cb6dca4441fa922df0f3b15b7e8a15d6d9c5e8a7a3a579e8fe13b06acd5d634c2be646561d61ea5e582e60633a2b08a69ac713ff31ec53c3b9dd105906b268d3547c341f29a63eb842660c5aac5cfda1a45fc9b6096df3441b0822b003d6cc050d1fa06c4b2b2917dcb0aa65f3332825cdd69b4b3331639a62c07aaf59b100bd5e0ef672e1dc0ecd8a24c0a297b4409739bd7e9f7ede2d8499b57dd10a04a8655d2499da24cece33b5c0c8a73fa29e65c167fa4614e778be410");
    const auto sig = ParseHexStrict("4254137e0f6815ef74c90c3de3d3f19bca43113ad449fbc8ab2e17d74c70637bd8cd6310151823fbc27f5e41c59fc303fc28c76586852a9c757a9c9a9b2deb6392b2c2de93a5ddc58e75845ccc23d8213f0986a4ecdf696863ef7fc7d5a0f0f60c396b6f3390193f976768e56663704b4c682acdc4d2f6e0c88e35a7b153920a3794395232d407cfb7a2d16d178101db0f1d3e48787ccac8dfc64a29d7b9f3b68070ecca5baf2977c47b472e2c1a472f8999a310feb0fafaff86cb04298fa7fb9d5b2d673b5065d356f364be0a39da2c76fed0afe5fdf1f2396636000f0c948e3948c3fafbb515574bedbc795b720ef6f3bd83d4bbe55abce0ba3ad8009e7cbd33c5ed5ac37a82d1546d0dbe61f0c78dd2b7f5fa0f0aad746a9f374aa4370d5e4e19d16322087b5ba8b04ce2d95832b5483fae9b0e5a9d5d5a3a3b56f925a604a0016320ac47cc7df981bcf587e0983edb45102116639c05ae40d73090f2e86bd97bdcbabe2e54f5a9b777749e72d49d2a73df3d97649bb0603ae1a4d6721d2ecc979c3a5c41151d2839de45969068aceed7833cb551db8c6bec73dc6ee5971ab595c5c5384a637a92f46b582550255367d81fbddaf60638c1a156d7a484b7dc012ba57e0c6ddb26eb26b8de756ef0871ef539eb6acd4fdf59472e453ec9bfbe1bebd9627fe77fa794caff15ae90e2e43b000b59f52d5ef9feabd24a94800ce9b68cf2c9a40049c0eb46f51ecd8e9a77c2c4cf9f65c6e9acf9ed3eadbade3dde905fc64d73bdab4c62e806c2892a7315d2123c3066072587ce3189697731af132685eb81045fd77e45f6e02091f5b6c6d4111d15daca1af3034ec74a58bce9f2728d5f9754ca4930dd85a081a1f8fdc09d9d6ba00d2a446ce8b1206c6050c4b918c93b363e666b423e152bda1de6c439d355017f7249420dc23db1f6731ddea999f9b710821a37d8323f4e5f600469c1a8ad70e50695892173a01b294b08a5a9b99567420f0c1d5ad6fbff3315870408364f05a95142ae811eb1a16f1a88198445fcc5652d4c01b69876568b0ba55d4d0290d6c946a05adbc225178e8de1a01e4e2dbdba83d1be063d39d28725f41e6f408387cc81181add32457f1df50da47d981227c1e155e54b6612f2d933c0403f2e4142f04f28d5a80e4d0fea6a3405723731fd1cdaf598560e306d97de4e51058add2c77031c1cd81e44a20126caf3da79fba59113fa0082877ae44179882f644cbbfbb3c00121273d6b069507941891136963b536f7ca219097cc4c991a760b390aa8880afca75f76a8f5a3b2e8052af5b3c78fe3f6e37478769167fa101a47ec5c99f572b501359a3da60580f5b744296c4ffde78441760cd19b707d94d6fea17482e52b2d7e71c13077856de61852cf80828d30f8ec319c7c572a4ba1efc613c24cf9413fd330031b1034d840984e70c0dc3485d4335446fcbcc6248821dba3b14da4bb40a9852204e21e5d55057318526721412517700b19e373bae621c3cf3af4dd83b0b089c4a23f0e014509938edf721cccf13e215f1116efb27577b1419c9d4766ef2b3664a5a4ad37466464c35aaf8f5a6d6765f090fa2a48beab14b6bd7c5303ede125999ceec3431cdb6801628df9d8a15d095921e0765dddd4b2832369ebf4267d0e58ec20184d3fc65f2a79570ffe53e6d6f82eaac62255934ce92eb9171558f1b8f303a97a3ba811d46a3a46795c0b9e69597079ba6ed74361141a9c2c0000ea6dff5579a18cfaf041f38d871707f8d4222b8bcbfc8735ee602d984594190166d05feaf9f687f6f90e205b00989b11adf5c75604f491d247625607139dbc482dd9aaf3019d94749e80fa6a327d07972f27c5061b075c1d44289f8fdc810fc0718acdeb95e14268763a04cb968608f0449187a6f7e89484c3bfe085707234183eb916ed55a7e758adb7c541dbb0fee0084e5932d7cfe8f8e9e45486a78a8b3de91ea8a8688047e6f2037118666b761e0a891c2873979e3a5409f13e3046a8bce0329393887e52c84370130e23dbb5e40f7b1e32aff8060a5e2a94c237d28f31f9f80bbdc4cb97bd3a4a6836dfa6b6a3cb4b31204701268bdee318822968ffcbc8e5f776df59d4cd26694fcab407d30411705d2352f1fe35438b885eea6b376c181d528fd7e769fc55ea9ec489ce1075cc4d0e716aaafead5f6076d806bd27275837cda384fae5d04bd28e1eae5569cb114fea677e5a1055802962d47310d48f56b4fba4900aad5db095a54451bcf20f67b0ab0f06104eda0b984a2db679c252dcaa2e35becf92f0e00949bfb69c66f731608493a8a19c20a97e432fe6ebd6f6cba3c521bc911c084d697adafbc6d86d5bea362cbbda95d5170f34c5dad89331f437967a521f8d03c6e5bfecae546f85cdd4cbf068a52ed506f6f0ecf75c16dfa09d3653887d25319a0b6aefa7f6cf7397c09913183391706fd851b4d4040edbce3ca57e1ae03e32e80ac3b439364d69df7dfa1ba6f027e3a6ec9aafc7f8991bd8dd4f04bb8ae1577372c26a0078c40299223e75bc197ffa068083e5e5a414b0f817c1e11ae209fe65a66d50794084c6d26df84c4349aefefa4269a14ec7ea24be7a9d839deaf48cf6b3ac8b07becb17b25a138301ba350df8198480ac8115b79c714e2a1958905e763fa191db4a69bb66861c8d5f4d53b2d023a0ea32bf0b2a3b982fe2fc1cbd01fcac06b33f7e902663a2d07f3cc56cf551d1cc9f9114ff50a6a8fffd118f67e581af4a967c300f25adca3db9803a5c3fd900f9e3bfdb08aae6f8e7797db1ca2e34f19f94eada18dff7e07e5e2fe1d0d89ef1d74a91569f6fd66944f786062361dce2294dd94e311c7ffd62bf38909a542b03fc4f419c637a8feb75fe294ef66c3a5e6f2b3fbf74cf78ad92fccaf5a096afaf55493ad95886f9a38f874ffc503cf6ee0282d6dbba43ceee76d6e7f734d293db022ffbf3ec51cfc1ea2cd33b653d86e7cc0c878a238e757da49898f6c6c794a107da60a356bb9fc37da02323dbc311be768ae3c98175d2cb06bd2926b1f85ba92d9f64e25abcb1946c784831c391eb9cd6ccaae3342ec959d35b5be5665f10fc61ac40222eb4fd97d2af72b057352e2fa82496886feafab3aba0db07a626a16af3dd0fabdd2cf31aad1520749237f9613fe5543a39c0686f18cff899b51e1d6de0c3b5329a3f3a845a5334e8a2b03d9fea3167cef24ae4132980bb7b8d4c68cbc85d6177db6ca40aacb03160db96fa9d7360936d98a694d678d4f26c79b2fe638ff3dbd5f6cc038a71c36826b813adfb3310cd2735adbe6e6029b6994714effe543a78ecf8a16d29876d03fbbd4ce18ff6b9a9961dc0a61238ce2ee920d74a3db3d1c90bbc59d4313ca384f1e61a93e7889537cd77f79153b9efb2fd1fe2e9a033d218f0a4a59b8c791f8c158aa27cad58f50b533103658c57f071746824c5cdfaa522a3576fbb1ed3707cf0a6e457fa68dd67bc05bae826645d15f389551e4a7a46643e2afb160c3abf3374fbd069f617187356ef4863b71f0f6b8cf631c58319e669bd38e22ae53dec2b051d2d5605bb9ddabdde9f164b55debb78bf05bb7d1f4ca73509c429c9cb4e9f8f28ab6191aae4def76db290ad0902bad0d3377032239cdfbf9c7e7f7800d0bdc9f578323eccebc78625293dc7d0080b34054685c80beaa545c45cafc1de5831ce04259a41a27e59f7211925496e5fbe040918533d35d105a253440a4860467751d17acb8e4a6f82f098a57f047a222142b0a878b012a68b1f16fc673b6d822eed9ada71fa75ab3b3182b8fbddd7ce89380fb8d0eb6fcc74ca31d08d1c97690e7c0cff45ee9637dda95fc68c976b36c69b3a3ea0d15619fd18a903e81d51a2b5691f59e0f994c9436005232ef75189214add10f418a60c5b678cacaf1651efcf6bc0b1d5a210daf54e1d718e2d2b59fc95be05112616af477341a94120d644b1fa674add130d816d2675931dbe55d66ae6c42ce9bdb509ae3b3359a417ab8e85e0c40d67e33e03ce53c3356ee63cc6f9fb5e53e2662a4df8f2099899a19e9d1e34a4d2d057d5c53d6314be8d5d6234f4df81b23eda99d2b5e02675244795f079b82f2433f9e6bd320f190609c49a24b445923e11e27563d2ff2018c091db0f5de294f484f944854199376e712dba0e05d855dd159324968f405c7ea68abd342590b91d0dd3f522357f9192b84d7691a303d6d4c2235e0859065b265d2ef13f8b3a944b09ac1ea4cb3fd7b0efbb146552fc0bfc2e3092bfc918b3c72e50bc66b1b7ca8898075559539b4207858ecaa9ba4d3352b4dd2c2f4cd6dab6d752372646a2c44b8c181d8fed2df16167b176ffae9ca8cd6fe0294bbb43d41992e503e5511568bba3683263fd2b7e8f2d1ef5ed2b51d2d2e0df183a17f15d6bc8b06636e940088da4fdfa903d5a0001258a8d990e2b4ab1e364683958ce3b8d7769a37a96dafe3ff12d54a9155455facc8f7bafeec650bb69080b72778db088ac342c7ca56de556671e1dfe4d77c86a7cafd203a2f6055737b94f5b77f4987d7f58f549b1cc79bc380dadc2c8521037ce9e6c35614761bb4204e8e6d6a4e73ff979201a66a72e5c36d855995c340df21dec17e8002d090e371dbf59c170a522d3931d8ea225144cf577914dc763302045bb12f7eef18d9c6c60a1ebc56f5d11765a86322864752174af0fd1625ade119a24936a0fff9bee294359b1c93f347c4af573f0eba77508dc15904dc2c405ec2453875746ac0bd325ff44149c3f056fddab7f7a1b21438fa727007291202cae24adc6983597fb8466c5be739dd14499bdfa70fdac47935ee94a69178f30f2070f6a4ba391a4aea5a9121eb2906a7d3381cf5989f7f0795583416c2c383787aac2f543784b968630c04176db3df847489fb3829160586617f9bbca9912fc3489c96e621af913076264dcb66e6511509a018ac739922091e27797d2c57bf3167f5438a49c6ac30a9380d20b04edb7010f1ee9715e08937d3b307eb9beaa748cf139f0f43972872d3cded601bdf2d3161bf86c90fdbd30f29e6fbb935c79491c6ec27cd9d687412349fbba0f5071f726d29194946113951cc9e3f471387878ac24e4d0cfe70a3e8794d6d49388e7c513512d2f4dd12c3f9a07cebea59ff539b43c9f3a12fa4443a5b6a3ebf799108b91573e495655b1e364ff95d7657668a4c70bcca4dd3f1094feb58e83e548b601675a22cfbd59e0f1f4e5814994e98af7c29bd743d3a2ec7fd7f8595f0e736f1feb7a8712b6feb3afc1a229a121ddcac22ccc4942b069d74f966e6dc14e70e6d04241a4661b4ee777e941ab249593d35e3dae9dec04b7e013b09f9dc409d85992291b141038e085496fc6e9fce3383fe0b99e47fbbc30afd759f4eb5f46602c1e51e50b1f8ccd5bb4da2765eab41d6f27b2e98c27ed52477a20f37f2680e7e1aec13601e63a997650f9e6b48a0d75a275e701c92ec4463b02e4c42f8031e1c124aea1fbe4c423e6b344c05e1f9bf434d4035f436b29bb57711afe6f65163723c0214d45529cac2a097d1db9c874d5e80469c6eee2014a6fa8db1eaca901d10a803b83571275354dbeb1aeeb72920d1ea65f70f7ae2f8821f67417fd4aa1b3079287b4ed5d4533a38d8c88f8e30f342955041fd27236acfb9f39772141aac906442e5acaa7b52569dea88ecedd07b9bf68749f03e45ac7ac107d1590ba3a411232759b9da747fab0595be4236bd6c976e4573ca31b7b407f53b06ba5c740faad3711eb74e2fa448e37a0a8fb0521c1f00e6b400e4fefed232036fd75c9306fbe12161f3e0ada4d33f383c601763f0f9c8650dcd191ec47a74102e82593bae59d951d160b2273e0872be34abc1328b904a8461e79833ef503b9d59b53d7f2abad74ef731f5d4cf50851fa553b64bee8467ae628fb41dcd481d7d27afea97c7ed467a13e412161acb4f5674f1f4d581ef2b4738a799cc0954bd997d46bffa6fc3ff0e428e6292e19fe5e8acc675a5fc8d8e52432237f1f770fe836b63c58c9084d9412e9731852b069492601c411a4be1fcf36cc8df4efd85724714d21fd15b9f7eff74ce1829182bb0ce7bf6ba3c9f348e139355b5616fa78b62529178d2da81fb6f684db815574f1bc84890b963f94d532f9c6e14b33e256f6d4c846be55d983a7d90f2f322a14c14d00d37d48ba403f10d8439c96439460e9c962c51f6c5d68b8c9ebc0e5b2e7e6bfeac5d8bfe5f0bc8e0a11f77b2c5e65bbc3ca2ca5a127fb3117e1ad103657e675960356c72a3477c411282da87e2270a67bd7e0c94908e42c0b1ca1c08ff5d32b70b18eb262fb85f5af9d9f5ee1a456ae43874106997b8260432c574b86df1754312b6d9a58063db2cc5cd91c2d6190062f86785366c5eea359a88e12597d765872d0a2f3175278aedeea14343541adbcf2fc0b375b839798a3d2d4f6fa2a388889c5c850b2d6e01933499fa2d3ef0b4983a3bf62637b959ab5bdd00000000000000000000000000000000000000000060e191f232a2f37");

    BOOST_REQUIRE_EQUAL(msg.size(), 32U);
    BOOST_REQUIRE_EQUAL(pk.size(), mldsa::MLDSA87_PUBLICKEY_SIZE);
    BOOST_REQUIRE_EQUAL(sk.size(), mldsa::MLDSA87_SECRETKEY_SIZE);
    BOOST_REQUIRE_EQUAL(sig.size(), mldsa::MLDSA87_SIGNATURE_SIZE);

    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> pk_arr{};
    std::array<uint8_t, mldsa::MLDSA87_SECRETKEY_SIZE> sk_arr{};
    std::array<uint8_t, mldsa::MLDSA87_SIGNATURE_SIZE> sig_arr{};

    std::copy(pk.begin(), pk.end(), pk_arr.begin());
    std::copy(sk.begin(), sk.end(), sk_arr.begin());

    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> derived_pk{};
    BOOST_REQUIRE(mldsa::PubkeyFromSeckey(sk_arr, derived_pk));
    BOOST_CHECK(std::equal(derived_pk.begin(), derived_pk.end(), pk_arr.begin(), pk_arr.end()));

    BOOST_REQUIRE(mldsa::SignDeterministic(msg, {}, sk_arr, sig_arr));
    BOOST_CHECK(std::equal(sig_arr.begin(), sig_arr.end(), sig.begin(), sig.end()));
    BOOST_CHECK(mldsa::Verify(sig_arr, msg, {}, pk_arr));

    // Negative verification cases.
    {
        auto pk_bad = pk_arr;
        pk_bad[0] ^= 0x01;
        BOOST_CHECK(!mldsa::Verify(sig_arr, msg, {}, pk_bad));
    }
    {
        auto sig_bad = sig_arr;
        sig_bad[0] ^= 0x01;
        BOOST_CHECK(!mldsa::Verify(sig_bad, msg, {}, pk_arr));
    }
    {
        auto msg_bad = msg;
        msg_bad[0] ^= 0x01;
        BOOST_CHECK(!mldsa::Verify(sig_arr, msg_bad, {}, pk_arr));
    }
    {
        auto sk_bad = sk_arr;
        sk_bad[0] ^= 0x01;
        std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> pk_from_bad{};
        BOOST_CHECK(!mldsa::PubkeyFromSeckey(sk_bad, pk_from_bad));
    }
}

BOOST_AUTO_TEST_CASE(mldsa87_roundtrip)
{
    std::array<uint8_t, mldsa::MLDSA_SEED_SIZE> seed{};
    std::array<uint8_t, 32> msg{};
    GetStrongRandBytes({reinterpret_cast<unsigned char*>(seed.data()), seed.size()});
    GetStrongRandBytes({reinterpret_cast<unsigned char*>(msg.data()), msg.size()});

    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> pk{};
    std::array<uint8_t, mldsa::MLDSA87_SECRETKEY_SIZE> sk{};
    std::array<uint8_t, mldsa::MLDSA87_SIGNATURE_SIZE> sig{};

    BOOST_REQUIRE(mldsa::KeypairFromSeed(seed, pk, sk));
    BOOST_REQUIRE(mldsa::SignDeterministic(msg, {}, sk, sig));
    BOOST_CHECK(mldsa::Verify(sig, msg, {}, pk));

    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> derived_pk{};
    BOOST_REQUIRE(mldsa::PubkeyFromSeckey(sk, derived_pk));
    BOOST_CHECK(std::equal(derived_pk.begin(), derived_pk.end(), pk.begin(), pk.end()));
}

BOOST_AUTO_TEST_CASE(mldsa87_keypair_kat)
{
    const auto seed = ParseHexStrict("F7052FBB921759CD8716773BA6355630121D6927899FDDA5768E2BC240FCCB7B");
    const auto pk_expected = ParseHexStrict("18DFF392DEF5756EA23519A240E6B5CDCF912D89CD94DEC9DC71E53F8CDF37D96CAFF7EB6F182B85BEC2F534DCB918ABE8428E341DEDF6DB71B4B805767B6C9FDAE294BE7082D35FB68C926500F287602ADD34C3F95E2D63B48912AA476A4ECA076EB040B260303E412DB261F1D4741E742275FDE42156120B8BD6FE6CF4FD54EB2271F8466C73B20A7B230CAAF73C55B4F351D4E93A06940A4D4277DC0254AE825145C2E4A06BD33D822446A0DB08E0D1335CB0BFB57094CE81AD2B15E1F0D52B8E548170A8B44FF9F2B80AC88608DFD89489C114EE7C88B52ED2AAE5720F46C23265C67A24CBAA3CFE1358DAAD57D34CEA19B74AAF88FAF6B19250EDB3B66C6D272FA05F896A4763A1D60A5B859B214596A671A5832E0218C808D22FE2DF4AF850C638B81A682E68793F3F1CA8A5261D7104AB340556D66F40D5930AD669947E484CB965403FF5E57B935BA29DB5B97FFFF164E9508816E2CD811B8AAA768321FACAE3CE2B2A9CFFB2E4F1CB68CAE2FD672C314D327DCDF46A91F23929BA327AE8A8646FD20229FC5D85149484BCC473F52D5BE9A0EBC57E2E252EC895DCBA1CD39584CD7FC14E96201D90874211555C4BFFD9F906876F3E112CCDE00914E3E460D8E95FDF0C65F70C2325A1B077DB3CCD64F1BED863A8E82FC122746161696CE0A30C03E99296DD5ED031BA7920CC15BA3570BAC1BDFE00AA60A3AFEB73FDFACECF9BE1A9E118BD645A821CFC3E80C284CA1C1EE1F7B5EBAC2DACFC39D486F209F5808181127EC012A486C521A478F478E61B43E28EBF5C94E4E29827E33384D33BF6F95E32D824E28D3EEAD4A0736CA14C21818665A2B71FEC36E49FC5CAF058D29C3BEF0403AAA6B28A23D9663FFA8BD36659BF2FA4356BFA22CFD49EE0457B17BC9A67C4D653BAEC1E345751C6208E5EF0ADFF638044CF67ABCEC0B88FECE6FCB04E1016408A70FB734A13E14714E96AAF18215A4831DC009B7343839C728C9B9DABD96F472B3FBFF3DB4F27D82EDF014707DFD7C7E412F760637DD07CEDFFE1AA673B8AFB6CFBC1DDA4456863545336CF222D843361B1EC850E2003B41066A7FB799256653A8F46783E4E55B6AAA07B87DFC54932A0C64F1543A9912577BF61502D3BEFFF90DE16B456A49149F7F0BBF4F0A37718AA99FA4803A4A20E4DC8CB398BFC47CE13DAE175B78A6A5BA18200D35E775A55596E1BC0E83F878612DAF3BA51F0E844AA1B5DFC8585D693800D2059C9E9B6135E094A9AE2AE06A00C43FCBE43AB22A344C6DF8C55C9BF1EF99F97F6E29A1FD0AAE7D2D1031B578FCF10E8C831DF2D537560B274D4BB305AA299BA64EF162083C20341E81916F065A483DCB9AF74AC78BFC4D19C4C42B22688B171ED10ABC43009E39E121AFE25CBD16F929D9EB164E0B36F17C286E5987D80B43A5906E3315DD3BCBF4E526FBA9EF5106837588256E2A8F069411A8CBB7FB7109C8E152F81DDE2304A11AC54EBEA1A1EB3AAA20311FB72FF9C8CB230B45348B8B031A81F68C2AAB84E5F6F977038BDFEDFEF57E4FBFBDF30B804ED8F3ABEC91EEB252EBEC52311C48EA0F59C36EF01A138E86F740C972285D8A7FE9B817E3E58A01F5FE60CDA1247C351AD0ACAA765351FC580A873E8ABAA728688FF7C044827D600AAD3578F6E4869FD2E2F75ECF38D577E4E2011B1CA14BB448F53596C5AB7E40C42FD34F147002EBC5765FB5AE3DF9A094336F85CA475FFCF43B7A998EFC9499D8636375BFEAB91688B0632636B692E39AD0BDABB5851334C7AD94396A10817284FCEF3436C93731F92F7021B272D6B8A631F251860E161674BDE79B245D86E9C9CD9947AEACD1A2AC7B319FECE3411C8C27144274D33CEA8D1B9F22411ECE82512A3ABD32D31C678025554157F309EAD3300360F3EE2B873E10ACE3CDC36F175497F095E496EA81E34C2C7369B5722259735E0ECFE684E875B71C4828D2A463A279C2552019696829AA64BED7F4C8E2442100901230469A9ABAAC443069B30536405CC3C25A11900DAF73D598A131E329CA35E6E7D8071DDC0A539ED9D7A4BBCD512595A931086128EE9387C904639DFE380080BCF56438F704F728EC5FBC1D543FFE7B76EB9497D2FE9124308CCD82939B66D478E123DAB08143BAEC36985B374C5FC88F5B41CA1AB2179583DE226BCFE1BA07F82AA38811F389A87DF714881B51EAF2C62E2D77DE24A59EB7935884348A3A61B75938AA5E7FDB5C1CFFD030EF41A18AF91CF96D55B239499826B3924F31F7C7BBF7466C5F69DBF67EB344DDE8E7246610F1B738FF71D14DA35B52D8695CBE8FA334F92431A629F004AC4FBA9400F2465030F19CAE0D34ECD485B143521970D3FB80DCF36B1EB3694946DD57C2016E056487518A3034E7C387AFF01320BADC460F6EDCA1098D07A52A67A73B3EC398A54AB4FA8F0862DC23D6945781943A0651F3A0315EC7349C33A22937512474F1042D5CEA69F3A188CE10E395E19C8A1921E186BC91BA8BEA87753C15699491296AF4DACD2D211B3E98A2CC403F3545A2CED565400364FA1F86F2BF6067A515F2E3AB1F2DF934F7C5E12685C7D87644DCA48E6A0DD272E979CF35E4A0829A494EC779A9F7EEF8C39FC2EB101CABBDA7C1EABDEA92A818B628D265BBE4E08AE1157935968353ADC6B87CD0D7CD2F9F724CDF1FAB5A6CF0B145D559859F05F54477B543D2A6BCBC27C460961A7FEF9F8A3F661B8BB581717CEF42342E4AA7D11A7CF2BFC7C0F13DCC18F5D2222935CD9E26A28EDB13E2C34C496B2D1247A3DC7AABB919D23045545666757775FAD49684ECE444C8B0A8AF1E1FDD17EBEE6270482327CAB00C382526028A48D77039A3147789D326FF407937B6F393641BD6727F10AFA6F5222C502C420355CD1FD8860C6F24459E30FD8DB3BC0830340E2BB4A707DEC0EF6FF40090885474D361888573AB3CB9A17D3CBF895764F202E74369D207055A8F4D2262C317E9B45CFABB34A9FEEC03193D502A9589B6B010CA2F429FBF4377400BEA071428CEA42A3F2C0B08173F279EE1292ACEA8A5C67F8EA6692CB312EF666917E01E731B943DB002F9A89A37099EAE6C1437BF22D5ED82574B6A9265C6A51E4B012B0468B8339EA53C021B670DEF4EC4D955E9F09250EF179654CC9897C685FDE21A4B5A51FF2A0F41C6FAF966EA2D6BCF32B654CA1FA0CD0DF62C78B6411151509B019E69E124B0C079CDF61ED4E534CDDC0A60225117312E2669631E353ADC1890F1E54A0922E340E861FC6C51037133002EB21845EACA15AE968E26418B8D5A88881D7B01906862062A8708D1E8C10F187C76DE78CC9FAF6D210DC4479F3A1D216477D1A1B51796002E572D01E763580CD9425138C1AEE52D847466DD4FAFCB59C7E57415E843EA76BAC9B4F3B2A80597F986222D385B99BC9F599C5BFF0638275485238DE6945F534EF4CC13E97379AD8935056045430A69B785A7878CC425AACC87C8AB35C5AC7DD32EAC31080AE99B0574EA56A2B8260594EE39B90C9536C2C4F22DB40EA71953A30C72C75DB5261C375D3E450BA741FD4EDF0C0A0EFC9D69C7FDABAE473DA7857576DE9112D60E12AE3646F9461A7032C844C41A30074874CE3ABC7505DE15A16698DA0FBC0D2AD86D64A8FD768619EE073EDA689E2430D9ECF3C");
    const auto sk_expected = ParseHexStrict("18DFF392DEF5756EA23519A240E6B5CDCF912D89CD94DEC9DC71E53F8CDF37D9D707D38455D5262BE13174016480537CA0E28A167AEAE91598B49FED93B94AD2B66C22023DD7F19B3CD372E14A276A44CEC10D377B88961FCF17C273781D8625AA5E0E304141057CE295AC59B1BB4C3F2B1E42F6873215EB70B6B524B84D46DDC84412E3A0019A020919058164307104017200398421A48548103182A440C228248B984000274C613625081106D9020CD1A848983681DA124E10360511830C1A8641424650D1C2649C3240A1960DD33206A2C8482433298AB6908C3268E3B84D1A32661B31855B348989B461103132640601111688DB2005C3C420A34629032401138909DA1608D0260810A92D5C0468C288800447501C2112C046280C024608104918094ECA100CE396600A29821C490AE1224ED1A20C50448199B00488204D5194919198055922318CA26001270C10872122334CE434001114889B1082033092C3A24422274ECC286101158112414820B570D2B06114172D03C191222842C24626E2B44C23C76022306690B81002B73054340062482E208029A1823012946D84102C9A2290213612DA86701016709A068580244A020869D8A680192182003206413488E14884533091243922D3C2010A236250088D88920919256E01999061A248C1064458280202C90CD2B4691A3622109801DB96699A20910281410C884418044A4C380A44482EDC048202178221440850B245D284010B8670414404DB1461182931E2388D5A264022452A53A20C9406225C908DA3361023952508A12C90108414052854A4280CC560C4B48D60C84424437220103109A350CAC66CCB462A21802D12B364A3B28D638004D8908181106D89066A1B466400B4511B20221493606140698084849140300C3289028285632848A0C220DC2452D21029082281D1203204354612892820474112176AA0104C59928189B8019C181009A644C1362181804921058644820121140802392ADCB82DA0A8210A022892026D24A501C2B861CC120EDC00628920608088701C9265602805DCB608E0920990B20419B520591490219184D0142E82184A0C0224533409C8108A99420A01028A63909120416208294612072E014111D2842881B0841B87604B420A201709DC224412B50D8446454B964942B884CA224051446A19A368E3802909930C8C1860584491020428A0B061A1C004C0000C1AA5845A487101248994169211926851048912A12D8AC6418226248A92401B436D042412C126252293680CB8606018311224640A4308CB3232D4C668A1466A0A886C92084040084802874D0AB25044280541A4712245406194450334418B8429DC1445C9122D88486654C28912383213C5008A966522484D190328C106014B10716304420817010B318119A251A2268E11B3000B930D1232891CA4495AB62100296A634446C4C08123879113B29199864999B22DE1A42522A84D98162483924DDB18890BC74960024454380CCC224C801466E2B4659C08224A9411D2168424B74048028C2141451BB98542C8485B02020109644940724904904C844552946C04392018173220258D81480254B488834468989264123229522230182460D0C271E2067120250022380E92B22884002ECC302513448622B3084C36866086814A40699A8049C21025CA08601499051A402648200C08006AE200421224320428221932901A05905C2831092185180311214112499824A2B88C01078A9B02881C005064368C10226D5A26889906480086655B0892A11045909204A324499B9891C9140D8212521AA4499800920A41201811720C8081A22249C284090B1766212708888421CBB86112486D634840102340C0C641CC402D08906501428C0B942DD4168D89928C893469E4A444D81851E410524CC62008150583124801C84512B829C8102C1C295141C40D58189293060280064E8C9488D03061CC324420C84D49344AC412028808059B940414314913364D54966120366023930DD13450842825A0A45112472E04808511965041324D02806CDA828882362E48B44C4346505A361111081054826021331022492211B44DC8207252489122952CC2207203A665491284830084E1068411C30C08266A1433899346644B469100010480242C144480D2020923488098260C1AB72111C4491182648B82681223692229046BDC8095AA4863C06F03811E2A8848D251CCF80BA1F64DEE2C7C1CDBD1AC37AC42C7B2A660F8C5A828BCFF10F78982AFE4C0ABB6D3AC5B0A475500B5C66250A23255FAFB79B0B5C500DB1290A09621B6772DF1776FF6B0943D6AF53C58168EC57D038FCE12EC6735194448AA2A87D00AB4FB33FAF61B6AB0F6D7A65963F9D46D645A50B7F495C2710215A4F0332ED9B0613B6B90C79C70AE975AA59EFD2CDFA9F777B65608E0A08C7B08790ED85E06F9D2E2E9775AEA198A6A97D5C27437DA0AFA6E11A0CD5E1FBEF1DD5D4430888BA75A5E554D2C2C7406834622979D121E2B59D3CEF3F1C70B3E7E1E0A3403F33FBC528DB80F7C3ECA23A4C357D5AC526D6E200133C01F72CB04EB4D07EA55185CEBAF42D44E7A34C214E531E0E2E8F08D4CD335109C6BABD1E1775E0001C067A42B0C7DE66DEE96CC637A9107C041FD90FFE7929ED210C71C29715C8172C9FBB7A694A41BE8AD3F5F10DAF567D3D6E15C3AAE4051F2693C1E58B08862C8ACF706416A088C3E3C65D9A540A6C65027CFA1A3CD16AA5B18BD3C5F785CECD714EBD858B40EC0E4E7F6790B8EBB495B2A38E04F5E67741CEB9A948E325165348108489843F0FBBF4860B39596A360C3ECFADA3CFD37BB7E025EE8C63B38AC7F0FC2234C427BBD6E21ADECF87C20ABDD4DDC1DAB22F8F207995426733F546BA135A4E4CE50E71D24C86B3E7D0990843CC3FC2EA8E811231AAEB075D1917218BA5C9852ABE28AB34990BC93A6FD7EE338E31A7B90D518D273FCAECE27D58F5A5045547BE5547715FB05EC53C93DD76D2C5FF4F04C4EAD0C8E019D2586F30F7E14AFBFD27D1C4DAFD616900DE1018F74AD5A9522392040D387E5566FD8C3EF7B5A89EFDB39D456CADC6081F7E124098878A3CD580344DB86ABBEDEA7FA349FC0256E6EAFDE4F57D4075486D940560A31CCA1254FCACDDC07A4CB0A57364B4B039C7803834A1E85EA194D796389AF28364242A57CC49F7D4B4F124923D50705BD9D6DA04720B817007CA611DCEDF17DF59CF601D01B30FB660A3A87B8085BEC72D0B30285739BBED124C4F50A3AB572530EACF1F7BECEAF474156398EC3F12BDD0939666691D89529612B7E8FE7B672FD4DBE630121B5F864D9E12C7BC1A953BCF557023A953E031704FF30A814934D368263D9536BF002D00244375DAE22905143A47FFF8777F8C8522241C0E28AEB4C5CBDC156EB45C6762058A2D53C81A29446C128171D13D24A6248341CB7D09B2F535E8BB528DE76D3B1726A3D5E3D6813990916B294945485B7A531076787FF4CA7DBF32D8B26C9613BBE2473680A8FC782843E475949711E3516DD563B8A6CEC6C5E37EFA9563FC9EE4454298077B7148EADB21F898D01452C5BEBDFAE8C9C58620E8553D13D72DBF05A8B82D0EC3EE2176B4FC1FF364FB610B43E766B61C9962BC93F63FF3ABB60A9CFFA19B18DF9C7E588228597B0408299010563CD8098974397FC84D033432860E84EB9B7A9CF1BB3B38C503D59CFAD70A488E8FA63A1D4DA15B87542C6C737C82A5BBF2A59894C4F44330948136492279CE52DDF007F75DCE818D1D58C41483DB70AB975F2D95611CCA577576AD0FBC23D1DD20C63B160DC227D7EB8D41F582170C3C59575F770C5C9CA702F3601D781E25A74C0117035AD742B5E41BE3E1A5711A2D4E17A0228CED21BDC3320C32F3F048476E2440AA1019C7BD076C8E16129325073C93F5E2B2FCF859428B51D827F372E2427848B7B24B42D18FA452B6614DD55B8382F9D1C98ABB0AF1721ABAEB0E7BDF1D6752B130A994B9C940660259B690A0FCEC5AB3668FA41E24C3D1D87962815D739CA341D5C4B687F3DBC0E598432A5C9CE6C78952A79DAEF94925787C34883A16DEEE435711FC41ACA62286C46301A6F22221C57DAD0686D0AFF2DE15D8D258EC01A5756DE75A67246E2F9AD6705A68EBFFE08BBFCF000412A22648A6A84A0B4310D63F460E012710D95C0728176019E361B100C5C531AD55AFF9A6C613BC6AE99456CA03FB2A2A36907FDAA54F91633CD35CE7C9926D46D223386F517874D6905D39A6801FB007C39B36D70A39A4F0E39D8D2EC8594168C3D4ED10C200AB3652C40E1779F582425594CEE70363CADD3E6A3C06F7548A76724A087633DAEE1F87FB4D5C0FC490D57A5B7E4348D9436779639E215E0DCEC31987772AFBEBD6D28B7222C999320E5F8262614207A7C02E07335BC7F69AC76CB5FA2F30607CCB73FD9A926CDE3CF6D31CDFB98D6BB0F55BD2FD7AF2D0C92E5D8883D8B3A471509682B850DDE31305A1D29D501A6E0E094845BB05B0F07C40EBA4FE13BE407CC41F5AEECA943960B0DD05497CAE56E6E22A70993C6B85B49682D5477A9730C4F99EB54D598D9B3F8232031E1812C2473F5C88D6B928ECB126C0FF020540073C0423EF3B44AE35964D64C0210F67095E1E567D7F742DBAE21EFC433EB900B6640C4DE1FB8B1B6655324B54FF38B02BCE7E00BEFF81FBDE5B70DADA4EE409483275AF77B75C844FC8043F6DA74E4BA197E81EF7169D46D70226E29B9F48282C4F10F1BA297369B09FC6DCDEF3ADCB38F0B2C36E0BB5A3CC84DED2925E315380598CF85B915FFE70A6C74E9E1FFAB173B582D187507DD80C7C8D33DCF4200B47AA3B5211D3AE01968349B14D3E985C95F2E25824BFC22CAAB2698E2D568B9C6DCD995E5A17C90D680DEA9EB674487D2A9A8F71AFD28089A3F301CB1EC1F5DA5E70633A8708185485CB95088698ABDBF172E440C7050952081831AFEB3FE91014909D7B8A87489E77C37F17F8D2F670BE73ACCE286EA7D1E33DF403F0EE2EFD5ED412AAD3E0546E122F6435880207B60FD15C5996A996A4E7C129C679C92BDBA9529A17306444C4F523E2CCB7434CA4960EAEE53552EC03ACC0BE4DF7C83476BFC3D446B673672A0B4872C63C6409711EEB9371B95BCFF1A5D89A4B285ED40B55FB6311C6BE8C2B5BE04A387AB67B175348B7401E565FED5B2A3077AE35D9DF95D3A152268CD4B141BD92D886436F9C006A98C271D92764D0EA580BEA79E360F9AA71F1AC6FA568D64C0A091940F872F98BC68776BF1B5364D6207AC697EB4B694BECB289B20081E2C33590726E9011993562DEEAFA3FBB8D51294A358A3C59EFEAAF070A2600E04FE06E6536F8FF3F268B4FA5656D438D2294EF1439E4A07D3EF10DC857F358FDC3F9C99C751901A015C238209AE3B74B9E169E25E212EA44DD7158AB2FE6F9082C613A488CE74FA545A8F5A6B706B8587F12A9E39229DE2069968D700F2A0219BB49B3361D696D5A10CCDFFFBE41F32B38FEDA79C0A86B9B1BED5A087EF7F7AD2D5455083733919D19EF151C5073C9315CBE479F0CA6737861182E80A3B4E0710AD4FF7F2F904C46DA58E7D2FCE62353C45C641D30B0E494927E4D6971F7BC07B853AC40C312798727E80FA4E842DDDA9DFCAD19D1F7DFE059A7EF19EB2CBAE61B8F64E4C9F1B41EB142F2ACB79B44401039F53631BF479944754005EEDD982356B1EACF020E8781FEA794214AF6C174333EE8A2F82F9CF72CF944B21B493BDD2B7B562A4C87D85AA19C35CED4DF069E75057DE578CB92EE6C0F5892BDFC2369C35305180F4E5291B278D56F5E4A851D1949B9747F4C788B3EC0A0B4B68D0020DA8A96C0A79E66BD4094C54CAA6B9A59EBC95BF9056AC16FB8F1C46702A091D1DAD582B27FC7656D84DC1EAB6258E35B78F5016236444B03C1CAA66326B73F786B0C85C7BEE4AA157C6DF9F1C53238010A95515248328CADC3CD69EBE7BBEB87B5AF5D6C16ECB99ADDA7753BB7DE09F3040A1BBAAB040E60CE708FC25E66987B7298201E8C5A0121CD14160A0088752AC499FF01CF361249CD2E436465E99AD4E52D137431A271C56AFDC5D527DA81F9B29B59507B7D0A4D8CB3DE03135A8751098B9A05D7025B32ED98CE72BF621BBE5BDC800765D4B4E295CA02444A9631636A56C2D123589E67DC3C8E06D0C9572DB29E160FF2DA6387B2127382BA891DF5B1D6DB7925D941EAABB55958A089CAC6AFE37C224427D917B61AAB363242C6385E4F1BC811B20AF66089C5B941601F1F551B385DF3D49E920DCD9B5B0F0CF51B54A0D77378B21C1FA0DF2F825173410D292B8017441068BE8B6E7719747705B8AEF7899A60A823F38D72194CDA3C242E67EC95BADAB1F4124C8D2660FA0DE2D29D2BC76341287D8B68597E714D192BA0F15C8F9EE6B06E5243C5E57745EF40A46BD5342FC8F0108CAB434224CCF6E26D86977E7879DC21646122D8D8008BC2E387629C083738CB248A0CCC8642379EDF73B1A2C7A84C90E7394E4B3DEA13C210CCA51544C00D8E568A3688E77A61423FF2304F6091D9FFCB7C7BE873FC40A76C7389B387A407134F952A4B170F68C29A3B55D7E20185CFA2BBF69B2685C6A4246F14C326E736F6883FFFCF5E7365607F199C952A570A4E753B4CE80C03FCCB765BEEA3D964DCAEB643EFA27E7A1BA71A0C13B4CF7B1021E2F9A2E9777DB30258A97314E2AA2BFD82D30D7EC90F4410E65BF89D272BD5EB9C158F3A440F2928474AA0FF4D5C23409F1146021C2510A25815CD5B4EF32F753AB8D95F59CCAC60048AF0A7688E5A3A7CD099DD1C4F0BE826F1CEB7F01A3D5614753A85BAFDC2A4F797B504F07B1C8281E12E4E27C883735D742812EEE497AC0A6C4C9D59D3D602FB0DBDABCC2CE");
    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> pk{};
    std::array<uint8_t, mldsa::MLDSA87_SECRETKEY_SIZE> sk{};
    BOOST_REQUIRE(mldsa::KeypairFromSeed(seed, pk, sk));
    BOOST_REQUIRE_EQUAL(pk_expected.size(), pk.size());
    BOOST_REQUIRE_EQUAL(sk_expected.size(), sk.size());
    BOOST_CHECK(std::equal(pk.begin(), pk.end(), pk_expected.begin(), pk_expected.end()));
    BOOST_CHECK(std::equal(sk.begin(), sk.end(), sk_expected.begin(), sk_expected.end()));
}

BOOST_AUTO_TEST_CASE(mldsa87_sig_kat)
{
    const auto msg = ParseHexStrict("FFF6591354123A648016BE8EAABE83362E82862BED61138788BEA16646D619BF841F1C16390B1125F3E8356C8D76B6E328FBEE06BE9CBA1C0D921E66372E4CB5834C0461A2AB321D8844C7A77D211AA724D995928B9C0C8980BEC26B289969BB8FB28DA81DDBBCBD8E7AA2CA263BDBD0FE47FFA1EADC6811F5223C5F68C0982A0FEDE258F118EE247B7F6EF4AD01ABBD1E2B2BC0C479A9720B7FC00BFF383DFD6F50CCD1F8F9FB2908C31A944E7490B52D3B97A6BD087BDBBFDB51EC42F6E79514BD693DB7D9F9B5D1E8C93F54694D5C6B0201E7CE51BAD88D84ABF1AECC12D1036FFD9CD1FBB82F2265F877E0085F6ACD00B954C7EA0512593A3970081C1BC960A948B4D41A5D2457C9D1D3641313C7F4B40DCA96737B4B23D2B62E2010F8F4385C8BF3CF541FDBCA4FC8423628E40F68598001105426EC9D1808F3F528741F0B08FC49237B2075B61E1EBD6018632BC6AC56943004FC35A5AF6FF0C9D5F9E80C285B9954ABBCBFEEB0060D89CC9C0D08D1C8EF10814766A151F4E03B0E26BC2CA789FC266CFD8E9B6716786B9E86998FABFFEF91269096258206523A5727042971AC10662CB908C15A16A1176CE9A8A32E3763134F2DD9B7EF29E074BEE9B1092DE554462AC8C70E123EBF0048854E627A11230930310EC6F33A2EF4C81B001916E99DBB4B22B4514193445DF4CDF21D1DA88FBE02C8F2CBA0A069DE1908A2579CB3CD3AA36B0B0ACF26D123FCAE665D1948FC6A729CCDE3244126572D847712B7410B5A2A0B661913025BCFAB170CC6F79763911B5999A70EF8450A851F0D2AF67D3A08755EF57CDA17C40B44DBDC6A4BAB763AAF6D8FF24A80B820874031D80E9FAB888157726ED212FFAB4BE428C718CD4AB7F71BCAA105BC60E7CCC78ED9C310EF6CA2F43795636D56790F95AEAA6885E71619F4E8FE0C4D7DB8ECD5DB288B0E40FA8E914C00E364ACDF19D6EE82754CBDA8F01AE8030A7EFDEFF51AF90F4D704FFE1823F7262DD83002F8F27C093C72D3E6E52899DB0C581D86B77AD81466A4D296DF2BF54833A3D189F6F45B2705B469CD2F60B41F062F290D6C2AC9FF6127F6541A81BEA63F03469948A00A366589B180793A3B5DF8EC189ED1344B7A3C1929002BC1B1B635E3076ABDAD0B1FCDFB42B7A406198B272115CB38F38A476D044654BFD831A741558693C5637F0DB850925B7CB97E836DE9D95C68F20CBB76CDCE3CBBC4706057BE71238A8674017E7DBE44AF00153C4002182F398866B27910193A64FD8B7694415C92F5BF85861912E5CEA585CC9007323A463A05A2B35167E2100D8D14634C63C97B911D6E7B485235DB3CB71A5B2027C87861D8D95EBDEEB0643ACED84EEE2186BFE0ECB7D0AB9B1E13635FA101CC1DDEE5DC0285D223A96849ED1A176766983BDEB9E678FF0CA47AE6AAFC0826379D7E51363EE729003FA559ECC4742682C9106B85D99F4A6E1524C32B8512C803550D624099317604C1B75831E7143067A66BBDC50B7B4400BFEA67B5EBEAB798D64001F5DCCCED87D577011E9F0A597CD9AF153CAB9F4356023E0C87B84C7BC2D5F83B40910A17BCA868654ED1473FCB72200167AC8D90128192FFF48896F03BC5D266DED6CB9CDB17C2CA3BB2C4E90232941DA88741943CD6110C2EE52E7E73A41713BA4A726090C889A941C967238DC0E52206099552D88DB150375C6564C10393A3D552AAE8559B273EDA1A22ED274868934AEF820748ED656433C7FCB70664C463B68F6CF65430128810DD403EF2E41833136CC885674A324149FE196824381B1A5915D1407C7C001375E9517B2FAE634D3021F0227E1D7888CFE8735444887262586FED55314954048E47A3E0D2022ABC525EF1979B7489466A0389D0808E5B18CA247D596BB6AB21B88B960863E38B59B9F4E39FA13C87D5C8580CDD6A0D8F254F06C45E5BE3B136FE92D4224A529E77E0F4DD10B4AB1F8E83D83C1DECA9B38CADE05A025A6C4D9605974BC0CB0AAE0575F8861E993D06AA091FCBA87AB6CD49539F2DF858146F6713774EBA5528AE4F81B6D4B9F2072CDBD9B317CAD4600E5351A0E9795A2FBC4AB27925C518DF5D20E99F09880A1FE93C198728145E21E0393D6799B34997EF8A3FDED9DC44456201C776ECB4994BBAEB54321149BAFB288B55690B7BE12596D654A2D3C50B3E6F2BD0E31087AD36A248E27BD9DF6E432D13A3E51AB37133E5D8FD9AEA3C949D672D127F8CE70FCB70701D7CAEC6FE93703FDF6762726C82AA5DCA1F531EA6C0C59141D773DE820C7A065786361C90AFF850B891FD592EA905865D0FF48AD1C8F654983E76F6E428D0DCC1911B7109086CBFA924E79D155ED0B8CE570753E93C9773F83F24FC6EA2759F2E12B7FE61D4DE6462DDC6693CEF94BD3BE59959C8FEEF79907D45E76DCE9C708E238CA91B0B9D67B1CF51D8B528F03E2692CB0B1203C3BBBCD30AFE3C8F34B4B57B912C2DBA5006F0AB5D8CB9AB4C9A7B8276A28251EB1F4FBA646B118E130E5B0B8302C26CC09D354E5CFE231375203F1B8C4F9D90C0397E5398ED5885544DA9809F2FCC8CB508D11433438A6A73E8A8BDF165DBBD8EFB3B4F8E787591B26891E76896FB1DDD3080680C2C8BFB880DCC0E7F0AEDE53512179B4DA9BD3671DE41BF3E137740F627C8DE4A11CFA59688F94CAFE66FF327CFFBDFD6F245A50FCB79DBD2228482597BF4EFFE15B530F1ED8D924FCD02EBB913E1C295D0BBEB17C6F4FF41C093241B4819B2D12907089291B092DE5D6C04CBBB9C66469FCB732DC619061D47C2A1806CEFBBD1CEA6567927626143E9B130CD1247036214900B04EA8078808130F4F2F37C908D391613BFFF7AD6ABD05EAE3E99874E3BB495FDFC7DF5E7E16656F4FE0D31A198F0CA546083B8F8118D89FAD262DED6752E0123951581578E769677F78C6334CA30111D70FD7C3DD82A127DD5835E78DE4D806141FBD2A90E3A51DCC19022240A5E7E30DABC24F590431E67BE8F92E05357081AB06E924861EBDA94F30C81F792D10D6763B1D0E66830D0D3443395E8CF44E94287B5F517C5E2E2ABA38C266017639A547761253D9A90CFA686572A43977D21196D985A2D2685C888EF6B7638D7562B6E762C65F05E57DBE1E21C9C8E6AD1161AC5FDB743D11181DD5183947671B2C223E59515AD97E61725DC2B3FA7621A0C83E1E8EA997A11048CD9FDD7757CB70D21C3FFA87755F802AF973155D69D5ADA29F9112E7FD485238E0D6AA59996AE563101DD023D4305951067BE1F9DA011F67F966D24D3E90FFEC53DEC7DEA086A6EB7CEF5E794DA71961EE4178ED24B607A8A54AD0304662526E971DCAFDA247928F6916BFD1A9B4A2D9A728BF90FF86FA1ECC6A1643060FF22CC1083DF070C08A9DD278742ED4C402CB8DE640488F2366C50E3BCE3CD574F7DD4584A5BC8030BFF7613EB4665C085A8A96FBB80DDD37A176C4BE2120B7FBDC96DEC0272F5EA9B745F41D80309A2B832F6C7628B20BD69D6CB3F4664786A404E17F4E91DF27C700BFADC3E46AA4656B2B05A7D4CCDD4BE570AF5EE65F696519D8882496055688D74142F5FDE1473CCBAA53CFBC907C8D060553E8680F0843B5ABB52BA7600FCEEAB2385159E3413959076DFEA31F10CEF42F9495D4413B1FA29CE94F1A9044299906EECD5F70BC9AAB2829931EAAE09EEADFCBEB89A8D5D97F97D2168DFC5172AA7CA993BE0BAEC01B2E4EAA1ABAB774A3673B7C12FEA6329A9CC8FE30D7B8E9C2444DD61F9406264BEEEA3FEB6076389602EE46D613C6F842B927B421EAAEF55E2A1A80E34D8791AE119FD9E6F8FBB250FAE8EFDD1703DCC531139725B447EBC8C128D722D7238EF2CB5DE9F08C3966504D7879D667C677013D5816CC7A5D0C0B9066205F5C0FC964BF57A38E051A2D57E01182B0537C3EE178333290984E4A6EDBFF1AB9815671D028CD4296B7FF347FF8BF0AB4BBE80ABB2FA1A5DDDFF23201FE5B7D498A2606FAD64E985E275E932E011292DA4038BA5948A4EF9841481EB12B69F55B1D45828B895AFD763143500F49F715FEB35D7BE3A69A9F1CB19045C3B4C991875DED2527014637BC1C60E3D7C19138971BD38ABCF14338427C83D1C10719D7251B1190729E31C24E1A6D36DEDD0BA083615CED9BFEBCA8FE5FB368C3845219533FC0E3622499E3F96F89799A418805D5575613106D16F60E83B51C823B31C783F77866E2E0F7E9746D4AB2E4BB2CB37C4594054BE600CBA6B3D46A0E1E5144226E34B6F5044B796CA1F92138CDA9D2EDC32AE38F6435C8AE7D6B2E5A549B6D9E83809E9E0A869729136981AEBF4911D22ECEA98BEFC7A30CC2B18BAB649CC62397D071DF8C01AC7CA6C35707328B6FF90692F72ACF056EF5601A9FA6F34DEC7A70B43A1F32287525E968815ECD131762687EE9510746E7C1EFB407F12795D53812141A59FDD877FFF3FE61A6D75EB9681BC73CC8760E8E9B0E27E7AA1869245B0F68AD767B3339A5475F6F95D1F5F9D76E106A4BE0E490CF9A958D277DBF4F5394439CD136177886132DBD06CE29209B5F656967CCB89EAC39D39DF3B94CC2F4663DBF0281594CC77827047F90CA932889367440B3A59143461E2A72EEF0AD179D4DD16151B9D1D3B61D0D5DFBD4CA54568CE466646042379F00BC532D02E48584F0545B2EE9A57DACE8B105ED205402714785D3862217F1A8F04B07377EBC7722FA8E5FE73B9BDC507A988C61EB37EA17F3C1E97A078003503B86CAB605E8356512E1151A6BF643210FEB0635783D2FBB010D1FA4219A041F98CBDD7ECCDC4B70CDF49F1AE2EB2503760B141B9F9C2C190587924168F369B20C08058109C92C1406A5D194563542935E78A78B5C10279E5CD737F8F042169F88F550258E738C2D86602BC73A78F04D7082837F92F2B75C3D940485E6B284226D0C0D4682B325E1F83A7E036C6532516D2EBB747473AB964BE2E8B45574680473982C6CDA6D7C2C06F7E33E88F33F26486A0A4EC6F7CA8978E7B3FEEF2CE9EB7906F6AB8B7ABB776D726C3F0D147DFFD1D7E13F6FD10B6A43B7E795D4D9AE7336F05306E310FE39996A1FD2620E31607D88D88D9010DBCC1DE9CC89B454E18D44DE4D3E84FB88BA5581503B9D195400319BFAB666F341742ED8026BCB53BAF9A5BCFBB60E730C684F3F70E1950A94104587DD6F5E873A40844BB18163C7E9D662F536313999881F0B493D9133D5CFE0596633B52A1DEEDBEE255F968207B18CD0A4B764EAFD76794D078D4D531865E3E233891554CA8B1A5A212EB012D516888690B999B9A223E28B887FA53848FD0CD5726BA880482D8A4E61070ED00201CCBCB58650254B564DEC195D7254C98B61200EB21491C33E1CE0EED50FF0000BE8FAD47EB3AA2D1B97870D6BCE550E792371070EEBEAFC912B69207D40D2ED4B47D7A270CDFCFC683EEAAD1122FE973D6E2FB7FD4B57D39B7B926BA0025C063498206A65826C98DB6E4256BF766823971932D94707857BB23D34ED66C86AAA95AA13795685B0603766BF72B70A10C068F9341ABCF1A0581186E015F2A40F9AD10960D046C12CCB23EFCAE75F96F29253379166533BA3F67A6A4A7340D440025E1F09B9AC7407FA6F874650F82AB25BFA30FA42B66DA9EAB30D445ECB8C427A40C30211F2FCD34D7A47C3FD2666F3CEB9060F935E80C560210CB67FC1724233847CC7FBE97B5209D458D37BCDCAE7798D05C10DBFD6E708BEFB9D54F6B7A64DC391C81DE070D48A03CF7A4599846BBE51AD3767C005C54C8AA87CCE0565C94E9E7D0029893916B46D9113851371B12BB992BAB00634BAC3BB41570735421B17448DC75AA025510C6D3D9C8AD9809DD1AFA200208D0DDC55C7A04EDA4583F20A1BED05B15360DDC9B337CDE29A82740A2B9C8B274C37045A4F1ACB7DEF14443B10271D5D9AB97E3AD94C5781681B70932E3DFE89CF1231294AA06AC1ABA7160AB925FE0B25A2481A164A398D504EFAB9EC7724F52EFD611E3232FFD2D3948512C9A7C052C55D0A53231D872020735C3A734E6620B9DFB28988C3682FF56B27AD7A69F0BC896DF84297DED4D186E9E1AA62F54E0B31FF7CBA6449C0CDAFA22207FF0E0A121DCF3FB1499820369A16D3499117D2277326AB748C0E7BB92F41EAC8057EF85A2372B2351CB121ED7408C8E002E00F8A7A3776E7583D94D0045C727B75943F62F6D639A0924C6EEA1E03B220DE7005A1CD606C44D1FF205D2354818BAB3FE12629A7601881DCEAD67C58E6889AB82485D81DBB66CA590A56EEBB7D8D12DB32F49C4CD90305EDBF78C7269DEC561F1890E1A456DE348D7302AA65F64145B1FD0A354CA7B359162A3EFBEFE43D5BB4CCD50CB34F1FE5784134003219301CAB58BB63E99122F4255420B44C4675B17334B39602FC9E7D60F3C66FABD8AD36EE7B4255A5A0806862E7F951BC70E93EA0DFD8DF501E97EDBE61147A0985EC1EA5ED35358526914C1403B49AEA5CDE756DCFE587F7532423A0C78C46FCA47C1782D3BE9AF6570E9657C032744248B54AA8011E759D6EF254783B8C83CCF91C4687F6D39F9786768C4582E6E9B7AC5F3D5B494018EB041E667346117CD344294EB9EA20A1761083F81A0989ABC565AA89A86FD7E637C630A89859A02B7E9085CF3EAC5F5236079D333F87EF1BBCB6B02371801D691357EB094C56A90343B3700925366275891C09B5C8FB4E22DF7D0F415CF3DEEE99AB059121D87E3FBD562E7DAABE98BBF81D17506EA71418F91CE1BA96666962312AB7BDF25A82A06C786CDD04473FB12795A7C66610095168F7FBB488EAB82A3332B4EA6FB0419FD37D6068087D00E4C16A954E809CA4F605276E33FA661DDCE0655A153C012BCCD428630B061E78C73BE61A96B7988F8D47F0FB9B7D25C83678768671443CDAEC015CD70029ECE6F0B2EB69B29C964366E69E5206ED2D19AB388CF7FD1F3BB29598B73CFAFF762B99F7D8B896D0F0C3606395AD06D273933E47C6865586DED96B823AA35006A6FC93A5247A705B6171BED27EDBE89734C04C1733A1EC09C0BE725913F842AFA5EF3F7E444BA2BFAA71F9A290164551228F7A8D5305F5E66AE7E0C73A2ADD5B244EF8B42D0B16BF5D9F1D298856F1A175AC73E15376FE9EA35C896B0AF05EC7AB820981C7BAFD9660DDF451949942F442EBB788E278ED2DD0C07F1AA1879D51E0B1C2CB4B449D3D25665A30A4CF5F12773AE298424F796E5D44C654F8130CCB1E9910F3ABBA2F358409C86BD73A729725673DBE42ABEB01A57E856A7A1136EDC2316B17668489B4E935443D411EDCD2BF40762F00CEFC79B08778356F087AC837198AA40D21E79B864E7D4F25AB992DA3F472E4E96E074CD578494E101FF3567469D8EA4C70C722255F9D081BD1F1F9D59845626EEF321FF3C724D4541CFB2356991127957EB5E956D1D41B7DFB13FA4C9D5B1B3349FF95816E58F26A1DF4096B1B032FDC4E8730A378AC5E74C37E5CC98EF24816663E59C8FD661CAF6961F33058DEFC57DD894EE571716193B882F78B086BCC1124524A075AFD558D6CB224EA401707BB0955255B137C68A045A4B642E389518E4C4347509A05ACF2D45251EA21A7487ED5DB1469EA18647BB2D41D07F039DFCE9C46919885DD961DCF1F6377E82B8452BCB67CB357FDD4EDDBDD3E20137C1247CA4A05A609F535529E6C57BEF63048E0F4207402719A18A1FC9B9DBB20248A16DE69A8310C888320C8FE5D609FC17969886E449D82E0A1628B123E8D25FE40FBDCE7807FA9D14F48CE06F3130C93B42B28B3B97120570E5EE942025BD15127CC116A0443FCA22D41DF74F4914F9AB48D6E0FEE5DBA5255D13B7D11C7132EBDC29842BDC121223B070163C3762849DC0B09157A9F13C00ECF2B257627A92EA5A2EB2CDB2B95CDA2E89EF21DB9118106A1A4CAE5C8C1A8EF736E439EC41AC9F92F2CE5072EEB70C5FEEE4C37F3436D02C9F980F1A24DD297E24BC6AC6BCC8134D6F55126244AF022967D339B599B3B4A0ABF5B554FA0FE804319422F1E17332279A5C32E9D77B2154EC09290CE15A1347AE4B3AEFF0ADAAA13FE9DE6504EF3290E01B10ACFA63ECE5E4A502A4B127EE10FA26E114041342AB092C4CC36106FAEFADDA34D06A0D6D905F3E023258B3CE8BAD3F6CFEDFE06B14EB7BBA67F34B24E7D75B577FB29C4F6625C0F470272D26C4943F0F85EDD24A055AE66CBA74925054AF2A607F7762CBBCC559D12AE5C5FA57352FFA44A0D31138DACFE27D5815C0F6EADA3622855BF38E84AF59FE0A25D43D64C5D034883B2FE54CE6DB6BF14F6C1E58DB4FBA035F1D0663837FCFB85D1EB53BD4CDC53418D13A953982A3615711047F115C28DB0F11328A044D5A75C41ECE893DC20353EC30B4042BCA1491A70BB1DEF594D62CA7F2FDD721B165CDD6655F4D134A6D08F0F913E888D0CE0DE9533B6A1A31DA246BE2D3AACBF34DFF193DD4F9D8FEE5E375CB0FD0B8420E7B9CC9CB6EB17E0AAA5E384BF92EE2D3FFC9CB2B974B6BD7B5C2EDE924DC395CB7DB028C9FF317CB44D41F64AFB3A8D05EEFEB0914FAEA7D2968BF867CC3DECAC3E7FFA1FE41C3EBD3E02581C8943F744969AC03A6FC44B67D01CD63DEEBAB6956E8F9EF27F13A0BF3920658B0687EF7CB9D71282D35B2BCD62793394CB77DDA39D6EA468B0B12BA91DA3958B81BDD113A1A1A5BC5E540412E85FA3AACCCE52CEABF748E7AB811E6F9370D6D76E141D1613F0532E36899AD6464FF9DF10BF19F47AF3AFAEC3F513F4CFEC35F92A5A52E22EB469E6B2DDC25B960CECBF85EE4BD96A0121C0F64BCA7DD705FC08D530E332FF7FBD5C9883F5ACC495EA9E72EB0ACBE51B2A0D8D5251EC10F26AB87A86E180AB5FAA80AA20E4940EAF234827DB7041BE668FC6B18E8299F0577D8D28045BE7EE0279E33CC93264D1EB9C0FFC42438E8F82BCC66ECF931542D749DC95C67F9ABF1F9A6B69FFD47B3CFE864493C5714A34134397AF0AF7787DE3E301346F6368203FD56D9C77A1C32A5BD1664800F925D88E3BF92EAFCA848D26E31BC2FED70E64DE559CFB59C8601C7247799F74AF50FFB6001B7DC83685CCC0B764E7BE4561D560EAF761F8EBE899B9C165259755348BCACA0860AC6F4FC5B795D7326219EDD77D10E4B93B1BC9CE60B7DD180C4D62A7F9C7019C1CEEE645A4228DB2AA495186E9717309FD2E52CC66254F82A4F3F84558717BC3A0C758E01AD1E78DE83FE3B04A821C0482BB29658AB26375CEF1279BB065E28DF9AC18F575F5C51693ED7ED99B0E83CC8FA8BB4B0F756FC9CCCED5DFF88B6B57098ECEDE5E9BAD3E0628EAFA7C2034A4D110272BCCFC0CC87A77912333CB4F8ED7EAF9DFB364ECA6D478371C3DEA315DE2199B381A3341F35E72334B4281B63D4528D4BD8E26BE7C58316F1EEF6B3ABDB2E3A4E9F884A7ACA877F661D144E8338716877897F43196F393CCB1EFFA7B54E414802AB53D53CC917CB1BFBDA21024E34F095AB01ED2330E6A275C5149195A37B413E169CB82807137877A374FF11AE02DFB0944A308F805E9F637CDD4F428E6E90FBECCF042EE584E0DB916D82D04A1E52");
    const auto sk = ParseHexStrict("CE3163CA78FC9881E7E6A0236E5CF4050ABF431AB56F15819274121EA09448A3B8BF58EFEDF3FD22E37BEF0EBA8EE5FA9E85DF869F9ED4CB44525A58D2087C6923F0441A5387EA051398D0C4C3ABB682B73F49D02809147C580AA18F02111F401EBAB0F7090BC6BC6BE5F4E0580EA5F01BAD159FA8AB04BA73E5CD457118E167E4A26C2129119228719B3011242784043208DCB2508200021AB9485C1881828621DB202448108558068021002620330042C02C8B2881230020A3B24D584452D040824C0284CAA8894226110C313223B7249C3886D3186590C40C61C86C63A48D214070E4248C10C50C142611DA909124A5291420919B28924C406A03324211B5100187108A34868AB829C20202D9C631890489632206E34888C1106ACA166414364108284142966C24884819C240144428E3B2499BA221E3364908918C61883183960DCB8269E32202D0080EDC404C58B2512127695A3482A44460141084939230D2906D48002C12B08590B2250A82311A13102010110CB18051326288306AD9C840A14226D0040510B1210C082ACC028114C50D61486ADC04094906908AB22553848419312A5B802C0B226A62A20C11B068CBC65119344590264810426689042114420292162CD0028C210804932031134005DC2864532024CC4471111824CC9680C8140649349123246C12426DDA1468088441DA32420487001909658B960864848C41104A0B938CA4386190220600082181C0055A226E08318298A06DE0200140940409A230481400DB944920C885621649D28465011400C4B8811144061335511BB0258BB268080251898248480465DB442E02162D021205CC10100035320115508C926988424409C168A0248608B37184342E51A2311B462422C78C52808193B02D9C0448818000A1262191B26DDB222C221846C812491B056261A469483282CA30701BA105E3960CA2408AA282101C1271E2825103B229204891D1C431D9B08111A32C111281CA8031E1342E484629C4B221002740D844085A304C0C8251A2A49019146D40226C882029C4164D4B844044A0700480101C958819216A10B9889AA48510482D83C850D4148108354E8B46511A2706143488D13425009788D13801D98605480610E4346C88B24C60148A420625032902D22040C328321B2446E444491BC42411058999304D00096210394209B04103C30512086922032E10416E8B22281B384D54868804034594B830819491D3302EE0124C13C7515A1432148669C2C0850C4480DB142009402104223023C37061B650A112241189010B229049A40108258064C62C8C2042CC126023318C1CC63001075180268D04180C4C962492988D89B8659A4410601406C9C42D90448623230012392222172E4AB4219016000BC02C0107405C02815A944814252859882812C640D3B46544B42454B831C14260C3C2705440208202708A860DA09431C8144020388A9AB29004908150C651842066894471D1288C240668DC863191C46D09C07083C8488C022D22A829C9204913066D98104152B6291B0220032649A24811CB082A530460D24086C22229449630539880C10662093286522641E2828D1047500CA29004961161102922B26518438294342101208C4A102A1827410C26820A4145C9048E14A249CBB2045B948D188044DB348CCB220120271294126891026892A4101A2705998491A4328199806012356D18042CE1824D52464CA4980918C029E0262EE49668C09090234020A31006623889A4020651844122440503A98851424914C56D59C4294CA04092B67101180E83B48C64980124093224916508260CD9322C92403100B04D50022CA28831CC206162128894422924A4109A20289848841A32466088311344511A112894268C14C49100948509158D1917328008010BC408D11881A3146C01444414A185A19844D918409A34260A218DA3064C88024684A80C0BB4496020410BC94D59820DDA8441C3865109846D24240A03226A248825D00209C338648A482E24B76051481204335213258A1C1862D9B01124272E63A2650A3372081921210661C0464462A20891462698222D6286518312040B404D9C384213B13108942148C62DC4226C94C0681299702381651B1930E4022123C5508B1802D9A490DC426401C98108842842806192202400498D198684011171C28041C828285314249B829017DE42073C09B9B18C18EF46F3BE2CAD03844D3FFAE020B356D284D1E1C61285396541289A8CCBC82E46C60A47DF8385DA75E5F8E46968AC584501C6591D7DE890BB9CFA5851229CBD29BBABAAE87E0D5225678FD4B2A3C16E2A5AA1FCB9F675B2CE1008EF50B39A1914F2536E52B900288CFD3F62ED38016D65DF8A9E276E634BCB336BDFAE706C724E4B7A056280C05E76DBA0B30C7FBCB7E18603CC6D97F185529BA4F1429AA4150235C5F9AC7BCDB668DCA7EB2E671EF70A28B15FC0DF82BA82F1391046A8D95AA9E4B6F860FDC0540C85DF0804F685E6D6BC084E34D2D618D97DE93F00377F75066AA139CB624684DAD86E950138E88B17B218248F65437B1B3A9E4B0BC048AFCC5E1CF1CCF90822F3B85E71CDE390A03CCAFE4AB1BFD1C4096207C50C16D270D8623D6A3DE7DABE1A218CC3E797A815D095C2300994F100024425559AA28FA1412D63F0DC7EBE6094191F662BA91992DBC60882781D044DDE5757BE23C9AE503AF561919A6C7BED92EA24FA4F1C285365D4C17535021DBD9A5B32CA1774CCD82ED19CAF8E4B627B3446EDA8EDD6D91AD2984CEDBAE5DE6F11E86C40EA0A537359C3AC8A03AC88618B2BE69B6101B8D8D43E6E9CA326F5DBD637C7ABE0D4FA9818115E6FBDFB2DE3FC0A6437EBF3A096281BAE5E41762D74BA7C6A5EB2E6D35B23CFAC823AA32246B5438BA6490ACCD97E1A3167F4D66823D209921F9E55EB2F8F5B4AD00D777BBA30DED77046DB6170F3BCDA9C87234E773D6623701B135459747B85BD663AA2B9CA82DBEF589A8A3A3D9C68E0D95701C6C5F6B98D41C4AED0C42B4F15B1D53D731399ED0D73FF88766B41A10BDC384A6EF56239C1BE90E9B09BA6D3AB6EE5A1741BDC94A12872BC591E4798FDF175BCFEA72311FFDB9D56AB60FB5E5E21805DF74B9B526DDF84587B80751FE0061EC8F35C1F5FD4753E6E26D2397A9620D966F0E76E8B6E92442CBD257594FC58A20447C05E361C7B50F928C69AF3E1E3CFE37F1926357CF20B6EF4C2468088F755883EA2D5A52C021A730E1BE4F494E274E920A6543E35E676947B3D5A1C9FB9666FD5ED8FC8883359DCA62FF0D2D51862D3635B8C6C9A23DBE22D03F8977893B61E2C10E0BB7512B9D2466BC13D8E3B32AAF66D670EC0F47D800332A12E0573FF570D2DC964999442284BEB1FD2D5C9315396D80DD20CBE6420E7C44F4FD9A14B7685ED73B6EF0B8AD5D62654D9DD2C11E7F3D568B86B925227EF832D832D93661FB153142A1B6C6E0875088A70B62ED32D13655D84130177EA445D69C2C354D679C1FAF09FB0C194D9684A4C09E19EED60027FE26F031060524DA5D4C8B7C8487DA11C424A20F1485543D4E12633E16C83D298D218F0F155C38381C9557715D6D07DF28A88CD0BC2771F5F70D54B0E16F0581F0017C3C6A9EBACADDB04551880AF01DFE7C10E44A980894D510CB9F136F41816B578BD643CEBE6787F0CC65EA16987535EBD38F38DE984DB0096E0228D43B8CB0C16EFF5E37BBF0DA88AEEAD2AE8CFE69C3F1A442978BA36BB9DA199E770ADB2EB0C245AFEB47E4F2A700C9E1CE14F824CE380060B9DB288439C03AF6CF8A9ED6A1363C46EF7987783FEBB4D6FE33617D4C3C300501AB23C2212CD8D41181356B603AB4612E76EF33E5DCBF88D36E93B081D2BB6F73E3B6F35C2BF8CDEF23C8551109D8892FC6DE1CFC9E4FBAC47D031E3DD736DE631883B35AD59DE97120BB15872AD4F3FA9DA5B21A3385C8CD33E5AFA9ACCB2EB65BC1B4D05E8F5063FCA42AA17A032931306581B5194C2E68B088A7507EF7B6B3D4451373054483F73E2E1A9A8A8652F09725F12AE69280EB2F7AF97490E6927A44A0BBA80A1D4A4D7301ADEE33E84BEDD083FB33EC83121D18EA8BC577CC9BFD2EF68BE5E70CEE8E65B7366433E9CD10C6A9062EC655060118539C40880EC419A74D406EB0E6920BEBDB868C9FB18D0AE3C04DF873CFD153E163027E89D0D32353623C604F5958407D8A5294E16C3A5CF80048D508E3D972E7037362B2CD7A0FEC47CC1AB90B68C751A474C124BF32DCCF52889E7CAF9946D0BF1E90B934AC9EB8C45397961569E0B6BDF11E1B06FEB01F35F690E9E9EC062F7F4E1B6DD5A8E43A5712379077A7620FE4807F0E41A35B4A339879E8EA8C1F382D1AF2044960ADEFB37D7ABFD2F874B18D5A137D08BECC6B064619CE171D82C4A5AAB399D7D45BFEB3A9468591533B2A4A0D8D91447F82949A3C5C0C071C4D262EA7C943ADDF1D2B4A06CD75278725B2FFCB7DBD7B898665E8D9C4D4284717894B64A4758FCBDABE3377E4E564E091FB0CF22F4AD099A614D33581C427C8D1ACAD031BF86B2D7B27F992E271384ECD493299A43F212428D7487C6DE03A4105B7F4D66C6F997C180F4EE3250B3CEFACE487EAF56BAC2868786A005D9937584DF3DBA0AF81D308D149ECAAB49F39D0A15933C15D0E4CD1587F817DEE0545468406A6892FA3E8FA380D2D288102386ABFD95B21B19A41673E2808F02DC90CC7728A0B268423B2E5DA3325C6271F3666A0D28CABD8C69C9132D4B776151E69CD964D1E5F59201D5A79298305FC37E24A8A5DA9676526789249EEF0C10BF669135488D13B3415F07C1E54BD275989DA6539B9A23C2AAFD2DDFBA7116CD98EF6018DD609E8F9020DA976C10D5F9ABEB2E716B140AA5678977FB85933C023E33E8A397ACECD87E42428BBD7505A0792CE0FB20BE5F52362A9CCB1B615D663C43B094214139ADB669E2E1A06362AFB1E288331ADD58D4723D4E375F9097F1958022EC9DB8949300383A39E0A58A200D2EBBD05338C1B6971509B716864DE1754FDA727FA09C52FF778AF032AF8900CE3E02889139985EF5976D25497D2C61DD41A6299E459B176A83628C0D1CCC1B64F8BA517835727A51A168105BA302B92726A92E8676AEDF87A43EF90A3AC4478F3BD88EB3270374853DA5A685FD141221B757339EB26F5345294B6D155FC15C51F41B3D538029EF089FA6F30B4F9E5B6FE31D314B9076BFB5DEDD012AECC9F0608DE4A67FB95AA43F8813E23B610D20E2F9BBF7FB276B9B4A6678B639C743F36BEF0C5D8F2F3374F99C06072478BBC64EE8B8FF4732859CBEA00FEC1C73799F068DC68D43CDBDB538B206DFCCD588F378555A019745B839E2357FA16CFB46D344B22B1951F410FF075133F17E6701B5ECB3ADD5CDB0E279167B899C0D6E77BF37861DDB802D55EADD8CA53281FEAC0C29FC6BA29B6655C48101CE9A2CA5B5D119EEA5F2738B30CEC24D148FF4BEB151FD548D6415FD372B3D056F59A0203134D855BA8A668D8E846AAAB4264A50298CED797DC55CD0E9522B0350F73AD5BD51762BD4DC1A8D4331F609B284BACDFBEB3E0F782CA8B8C720CED9B753BD688DC038E163B374748506E1785AD022B6683F1CABEB4354555577F62BAD8138189069DF8A7B44F711A4174368F29D3AB16D50E703B91B76FBFA426E123598C3C8434BCD0B290CC3709BB39DBD3EB53A8627372BCA429B0D4BE3F6C5A4D8162F23261EEF4BE89407AA8FE52A44121D07B6A85171E40DA9AC7FA137ED6C482C09E0BEE156AF3DACF8BB818E5F905D9B1740B112A0C595D24705609F201AB4BC1D24829EF27A802613AC5043FF15A2A7EB9757E1DAC343BFC0BC62030431728768B2409034C9D91FD12CAFED306D4705DB2C47225B5268714EE5B1AAB21872C24505C271D33AA7F0851C5CD9368213A59A29790D909676E48A3F0595792538A4348BBA83363C6A655337AEF54003F6D93072A392A311D9EE88E394755A023C87ACBD89CC57D43B65E1F62A20330E2AFC62AB476F96CBC385669ABA45C39AABCA07791022F17532B8FE5BDB5B157F3741B775579023648180CE691E217B578CB22D25E843D0DA4A097399AD5BB86E11655B7E5A0BE70EFE5E860C3450AC9529BF64011275B2A7A267B2930A346AF2C1A9D15C2C2F72A3E57DA0C502137036F0140FB54BF3C39E1D153F84A2115C210A4A2FA658DA32BAE3A484E82245DF7DD5C79E37BCB5256A6576380E3D803697F669A33279CE39D07E4AAA3469AF205E09D1F16D7DF41C700A5072DDE666667CB720F91FE0A9309CCC43881A7AE8141396EBB0574C1E28AF9D1388D79240D92051E0ABFA15481A6CE86B82BECB1A0AFB9B68224AB1CC65C8FE5D44063285249F72504DF3CC02E4481236CDB33761F305D67853C1033D7A9B7723833F360FB320B3D2F28B2A3512ABAB88DF0953A4C67767930A857EEB4E90722D4CAF0B7D734D522CD2691255B6458DE86C8D201E317F4B937BEBCBE9942EF178365206D91CE9FB86F9E84CC8507EECE21A07D55814627C0AEF7B69BC194DF81AA058A74586D163DC5BFB2903F0D74396D723D7D369881A7CAD1306F24F771AACD7297452F2691B6ADDF4E9C795B968137F279DD6988948359415FEA44A6668A987AB48E0F3B53C327CA009FDB968B16CF8606979A8380057A12536ED458E217D37C3F4CB52F3297C0050FECA831C97A50C5C3A2E66E46327E37F27C8060CB0DE6FC1177BBBAE663414E1EBF2960E319911F8C1FD2E3CD1CFE9972D3306097F10A1EF6AF226B8EB7F093B1F6E2239E1833C588A03808D2E704F730268771F01F7FF8F5174FD89438B9F0878332B523AF2C88CC84D702D9B484B2561EA0BD60DFB8FA45ADA8025401C0C7B7B7AE96D5DB510");
    const auto ctx = ParseHexStrict("CA2AAD52AB8AF12CC0B9D63DA31BB978A9464855C1E0D281C6F917B5A8723DD878");
    const auto sig_expected = ParseHexStrict("4823427A55790F42CE80C0B75213DAAF2CFC0CF94AEAF32597AAD94F70BA9260019D65758A8AF6F7783A0BD7461048426E04ADE9178F60235BB09C65107E1B3B65900D1617821583D8BA3E96EB1C13324E95F7C10DC1EFEFFC33C8554B0C7ACC92D8E83BDDFC7E0DD2B65B2EF421DE0CB827DA71B5D072CE6225C91D1B2C5B39EE8F90BA32D62A23847FC6D4847305B672E47BBEA4EAF44FCE4EA121CF2289AEE437A71A0566016DF6A5B9411792397F0CFAE11F5101226ACD2B124BCF21ADB3D761F4E803CB8C6621496394BA3E9C5791ADBF4F41FE38B44A4122E2991E0F7587A25DC07944646B9F3B95653006640B31C44C8FAC70807D6993FB0904502C831C906385E4EA2BCCDCBAE9A2FCDA611B3910FED6DA159BA5E2E9FD9591332FC720A183C494A16EC63EDE5801D58AD89127558A78589B725AB3D07A8168571A5492253B8D0548669E302FA98F847250E93B30E69BE4CA0C772C17ADBEAC5F0F3498FCA6631C09A805852CABCE756AFF371D14BAA69747E6D67476491B0EE12032C2180A7486AE6E254F59081E4F971645DFB4DE55FECE847ECCFA35E4ECBB37A96BC94A95775900930CA4AE3915B9A8CA2F15092A41A5257742D3846D4D7D213E4CCE92281558A271586D57B118A199214E1728E81B9418F1C1389C01FC589E91861DFAFB2EEBF1FA17C44E204A46F4C15C983157A454E7367FD2DB3FE25415426DC195E799EE63E1CD75AC3E77E57787CDB4BE6FA88BD225A77E0C78819615E92D9140125CB5D6433EE597B9DE478B8F9C461C65E6AB2A5D00367966E795EFFF1AC8AFEAFB98A67037DC3973468A3E4B7489EC131170799495014DD9BC30A6B09EE725983E49CDEF7E91025FFD0150FB31977B93D04DB2750E1E06168F3613827222828D0DD7285F9EA570617910DEDBA750F46B0D4A4F7AE99A7E9CCDB2476C1FE33979EFC08B4496003D4A2BD6B016D6C5CA48F841A4E5EAC979EA7A20ED6466EBB58B49A19AD49E4CFC444CA366053240036878F351805D8ADA81CB36DCB0B96B7F361A379A545BD3BEDBFEF941485C65A3C53A6E34EB7CEA678E820AE080F511533A99BB01CDDF9A30C5DE0ACD91772757C11800AFE653C1ED69DAC6B82DF57AD745CDC6DB56C91B251F7E667972AC22150CCAAD14BC43B3EBB0EEA613A74C79170DF20EE9C74D19A60EF9FE4FD06FCE5F262A977356F54DA622332AE3BC52FFCD19F967E4CFA0CBBD0C57C7C6091156DF3FF4661B92BE3EEB9574C5060DD979DC9E302424A1A51563100FE1C1B6081964F60D12E2F17E41F6F66B4D68ECD5BBBC3EDB6ACD432B7FC8BA7C7BEE402F3FE7BE559B0B4E5E198777498EFDF1508D52520CADF7CF81BB968A4F3B4B0945EA67A0635D8F5C20464FEF6FB1D12A0EF65183098407986D7B737B4C0C91DD6F9C6A096E1CE0EC65D4CDE300A66485CAF19F38DD343E832A6846661F92FF9E8D194EB2C3BC932F175BD79B06E373CD80DF7C67B4060B106D9964608D30B4BFFF9EB870D426E4D5BCEB39856AD284DF165E4EEE170A47EBC6B7471E26667C4F8AD1190D846230FC3D9B74CFDCB6A59A4E19D904C83ECFA0F9A05671AB9789557681EE9FCE6821D6B231955A77C890ABCF3158AFF12D10FE92AE123858E787FB9CE8DDEA5D7BCC8A7ECF4C5DA161165880BF12873746DFB5B54B1EAC8B59CC676B36E411E4169381D4A646063E967727883FF972B85915D6F41B3039EE94E95479D88C64056661F7D91C354B2D2D01E427386D6F71E9F2CCCABAB7D5A9F91A7E295B6525C60EFF3A08F91037AA8915BCED46AA686851B92AF96D72F0A86B6752E4C339567C31C8EB888BACB6718C92A1006C0F1448AE3806D242E9085B385E15F1B98C2A57FCEBA183886559CA01C93E7F9CC14DBCEDA4097F66827376C38E527DD58505042BB3704EE1CAAF57F41B094DA683453F4CA1C5E9C58068F0EFEB22E7DD97B7903DB487BDC23BE4DC1E48DE322287DC79763327BB81DABED27CB11CC4F74B726B67D950D0E8A784B3EF6136BAF2F0B85D4BC9FD2B42C19DA445B87F7F400DA3113F4A91555A530C61A3CBA7B64F7445739DD42BF8AA31189276EBDD79041338324C768DB183BEF84B07F34A6628A8DBB14A1BC24BC1B018AB7575D1049582A2F7FD4B3DC68576FC10BB3686690CDCF55CA1E524C5554A293902629941A44D24E638C1B5FA09E806A773F8507DBD60701D5D017CF4E7407C07C1084CC1D057F560ECEE3694091E3ADF2D90C16E0DDF2D25977B693D9F908D624A12CB669B05C1E997585A43FE1D92B0059E763F8CC8637BCFB37A70C09E4814291DB0041971156711D985F76D620E72E4F731CE8B4EB73C922BB719729771FF0A93AC59C38DAAAC51451949D377DF1A95499E1FD95C13F93477EE15431CA0CDE351B396DB98F0E86E017C29D562193E21F72714B3AD49787B5084DE084C086DD7BE4857C84E1514465611E01AC1A85FEB125FDE520C7B1263FF84C00AC72E5724FE9B976BB2C4B3A20F5CA1ED8E8466F23E5A35745DB14635966E0A46D5751D0CAE21B24B54A759B4670A1F9B4B3520C8B35C16B12948486101986EEF14CF595AA6A0274C9F20A68874858812E5BAE269771D6B02CD28D1C57C9DB656CF296854D48AB52098FB61EA654DCEE4B2CED5DEBE5DF0BB15FA69A6B730466EE482F1DFCCF1ED5FA83A954A495CF53204B2665ECA210E8C018AE1B2682EF5FC3CAF73FC0D9DBD04BB322AD46A234CDD18B785E703F91BA11C92AC41159ECB94C1AF0AB2DC1356816834EA353ACDF2D50D07623C3EB8886A05B064334463CDA589D673C5BB4D777F4AA4D41377CFCCBCA16C80707EBE1E2E2A172908918D04BECC089131085AE93CE2A58B105EFCD2F2A7BF9EA7F134B11F3289479C20747B3CD3C60AF3CE5045110F93E20430C1922F85E9F07E2A3D7C26B36D3F0E03BBDE0CAF431331EFF3E9237A05EFF23A9FC81196704B68BBD9DC5223E244FC247D568964910912813D3EA6CBEDF13FAD61C9D54B08FCEC135C927CBDD335BACD410BED49177F2F58B167EE50920239C61EF0005633EBF8720436CBE9BD3C9CA81152756AEE8733ECD61157A1FA2138698ED4C33D3BCE7B345521CCEAB91FF47CD8B5F971F86284F6863420CFEEFA840499096E0CA95EFAEEBA0E001B0FF4B2C07138D6961A768E637C6B26A1D42C5FE8A12AFFDCC7548A75786F66798B1BEDA6682A92A52AC73D69710A5F562895D51EBA2738D20730C63CF1215C996C3CBFBAE76A211A1BE99118089CD223E845E9F5FB48FCBD3FE37FF0ABDE32CFB5AD0F37DB6133F4C4B78E76BA39361CC6D4D42E70091B63E8A21BDCAAD308455476F1A80E8868B4EE2EF04D98967E5033093923BFF3023BA31BA75F1DC86BAC6538C469C1A4A226442276398F01DD09B89233A650FFD4C430D3EAAA41B8DAE035406A07F794DFE8CCF64B34AEFE07CB085CCE2DEA8C498A91F3D5681F81F3B7AFF9EAD72649898655D94DC75642FF38E49D2EC75F7A88A436022E0B00ABDD56CE5B08D9FC2C902FEF35F06E1D947D26D3BACED2E5F9F48ECEAB304D4C43AF66ECD4CC21F0FEB437016A0C9CF5B1B610608152BA49D4A3763F12F6E642DCB4DCBBAC688D33CDF634341C9BAD9E4115A6D16194A9A34DE4219B0A34B45188B25BDAEC50494FE598330587E40780C987E86DE429974415BD2D4777A553F16671CE6201E39CA8600579652984DDCC5B0781C554D729AC19CF99E333B5D1CDA689ACA332DEA8D45E975517D817CE60AFF28DEBDE2575F4E16AA6710179A7D3810122B838A50FC5208584FB5116E3BB6BA72A187C5516ABE5597226CB8ECBE3AF59FC1E89B8B219E2E81EF1F42A9375370D8D3759BE7DF315114D09638BAC525E17EC1264F3133FD9E229587FFDD889A010ADD51B59B8135D21D312FB4F7C2439C5DBE91CB3D93F869015BFF3ECB6CD8DF6F6C457330FD127609B0526B8D07AEFAF62EEE79929702B78B0490BC9FE5F68A9CAA37576E501137CEB741EBD535CE3D57F5AC95A0BE2943CA952006F0CEF94736548AB7FC177CE3FC3D57E5827D41FE3E9445037609FAD026958A72F8427CE348BDD1E6818BEC57B116232C6A4BC5116C79C546E98AB80A00918121BFE12255877A2313A965E62C6F78044A94B76C98087BC6CD19B6BDFD923B86F7826B6F48FD8B9DD4CD5BE25266877F1336113BF5AE9E9EBF1DEF231C7BE77CF644A7433F387AA4873ECC1BE22F911012CBDE387D3C4059D170A7C3B85B4551265688831AA61F157693EAEBFC014B3CE05A607EA966850836FD069F3F8BFEC68FB973D6D31AD33C4057275F9C8A11AFF42FF7A3D5FDBF40226FA49B881A60A6B6DBAA3AF4F0BD746A1931CF507A2CC3895EBF35235FA58D2958ACEDCA2FF0AC11CF48E75771D1DF08B1876D8CF579BE966123A3F60EF43B8E531090930E4F7FACD37326ECF24BE2F59995CB1D2E95931767B85CF0C299B50BEA2D73E84C554CF0E36AF491E3A46681A47D4F9FA477EC2D0A88B7CB8D9971D16320CA4DBA14A8373D4C6BCB3B491115EE54096545D7DB9201967566E49FCD684F014D027DBE79C7483D3BEA7E316809D4F55A401AD974E62AF6B66A16ECD6B35DD14B3506C37F2BA6CA1ECBB8D07E2C4855FA6A030235569EEB21C623591D805175FC6481F9BA7192AD6BC4C34D948FA2DA5F712B6C772135BFBE7F992C1C0C395527E7A950084E72E0DB42347E384376BC62EECC6525DC9C59D071646C93151FB8B2CA97326BFA45174537CF7CFD50FF9D3814A4E61CDCFB039BF984AF6B7BF13442C4A3A5075AE7EF6CAC1ED2F37BD45E1E6E8ACE8BC89E3F73502D2D7658F69519A3D09C2BCCCF86FBB8238D722B89EFA585844C116B0F774EEEA8EC24162B024865B9828C00330F11A5B484B3F7013F58C00D2E228E72A3DB2604F46F3345F84C1D87D26449A82E13746A8E7671DF2E9AE1FF19893853F193FA327BCCE7633DBB608AF8DD841F2B13AC3A14A1E5ABA2168826CF4D9C7F07E9D440EF40808D4696FF6131EF03A72BA82BD03153D1B252CEDCDA889D4645F23EE5ABCEC424471AD25DCD96FC71773F13069901DB4913AB7692119C429109679C116767F8BE7DFCF03E554C32C0DD1B7B26CBA2910027C7D2D98937A9B1014A226C35E830B9D49967F02BF5CAB7E44F202CA9FBD88372021DFF4647CA92278EB6294F2363A5EFF55A083F57A2441B8D00CA653227575A721673E92F39A88A604F5DED2B130732D29449CA0D39EA9144B563DBE425E3C633EB4BD2EA036B6334B19AC71F19ADFCDA56EC8F5B242141FD8ED8212C99DE06DF3CCEE6891FE8E3757CF69E627DAA0B92FBD3C68DDDD7D06280522B1A2E4297A41F8F11B7219CA4D0515FEF18B4B2825832F691551A3532E8419480C5B946A53B61D9972C9787060EC1BABF53CDF110E64B58EC529AE930BC91236B4A163505C0F24E6E7588296A7A259B402763F7B011D9F01A516E48CACA492E2F1FFAC0828AA36B7B2BACCE7C241225C920B47682D384F934798D0DEC2CB0B3A728CC5DF5468A5D4A4B50AE703993D3B9496FEDF3D8B069F3EBF6ADB50BA382DBA71A9B6CEFE8046E25310193D52B85B352C27385AA35DA7CE63FC271B371E5D7C3FF4E0770DADBE55EE52DE089632AA6381023017DC9FB5DC179D214FC67F60F2C164B0D5B506B5EFB5AABD52ABFF0B9F239B7E5042161BDBE10A7B4BDA78B61A496E813DA129C10EEA011C28F90AADC949096113C8C234EC1F0367D060038E413984E11A1F5BF87A74B40B5CEFF8D54CBAA345340AB1E7A96F5FB8C5129CF247090DFEA2194720231A95292C26E9792E7D868A0C3E3279BF425BD5E9FA44C05DE3EC009FF3889540F7C89D1C388E05395F04A62FC6AF841EBC1662D563576B664C8E3CECDB9A461CAFFC098B56B8AC62D36EF147F072B8759FF04DFFF15DBABF6CBDD12A1B4A8944113245A9B6E9EDF5105C68E84380B03D748E29BF8CAAD245234E657EF51E8FFD87BE2C7014AC40457C3B5154EB2863A4270A8C7B996C630A31E1A1BA7F1B4D78F810254FA52DCABC8A426ACB1022C1B8C061480CDC1C6D5FB6ABB41181A3798B4CE0A5E2905045BAE16989ABF7E100BC403A7E9AF53E0A70007985E89185888B02A5DEE012C30008CE52EFB0E15D5B565DFB9034E0388BAA43B7C8550E54A2A36BE7A1400E1E287D80C68E78D63F6394B3B46401A65C6905056DACB423F52F8C539C59D27730612836FFE8EAA2F1B1AF165461D72883015BB0ADC55D954917C908E1D5F6A30F5DBFE6D128259B1FE1B837C3F619FDCD52C035EDA6CDDA3E5FE11FF804B1304F22F9EFF54DA870EAB868D9C08EE4A78F0F3C8AE143FDBE77807CD2726DBEBBC59C67747694907FA50CB1B20B2F22CFA7646D4A152FEFFDFFEF01B336574213000C2B8DE2E6425457AAACB2DA2962787F96A2C5E2232B4992A3AAAFCDDFEC455489A7DFEB060C1545576A84182C505459B1EAFEFF0D19202B3CA2F0FD0000000000000000000000000000060D151F252C353D");
    std::array<uint8_t, mldsa::MLDSA87_SIGNATURE_SIZE> sig{};
    BOOST_REQUIRE(mldsa::SignDeterministic(msg, ctx, sk, sig));
    BOOST_CHECK(std::equal(sig_expected.begin(), sig_expected.end(), sig.begin(), sig.end()));
    std::array<uint8_t, mldsa::MLDSA87_PUBLICKEY_SIZE> derived_pk{};
    BOOST_REQUIRE(mldsa::PubkeyFromSeckey(sk, derived_pk));
    BOOST_CHECK(mldsa::Verify(sig, msg, ctx, derived_pk));
}

BOOST_AUTO_TEST_SUITE_END()
